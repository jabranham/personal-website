<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2017-06-16 Fri 19:10 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Introduction to Data Analysis and Reporting with R</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="J. Alexander Branham" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2017 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<h1 class="title">Introduction to Data Analysis and Reporting with R</h1>
This is an html page so that it is easier to search and copy/paste. It won't include the figures and tables but should include all the relevant code.
<div id="outline-container-orgdf63061" class="outline-2">
<h2 id="orgdf63061"><span class="section-number-2">1</span> Course Information</h2>
<div class="outline-text-2" id="text-1">
</div><div id="outline-container-orgf7032a2" class="outline-3">
<h3 id="orgf7032a2"><span class="section-number-3">1.1</span> Course Information</h3>
<div class="outline-text-3" id="text-1-1">
<ul class="org-ul">
<li>We&rsquo;ll cover tools that should be helpful in nearly any analysis
<ul class="org-ul">
<li>Graphing, data manipulation, etc</li>
</ul></li>
<li>We won&rsquo;t cover specialized, specific tools. But you should get a good enough understanding of how R works to be able to teach yourself these</li>
</ul>
</div>
</div>
<div id="outline-container-org364dd44" class="outline-3">
<h3 id="org364dd44"><span class="section-number-3">1.2</span> Outline</h3>
<div class="outline-text-3" id="text-1-2">
<ol class="org-ol">
<li>What is R?</li>
<li>Graphics</li>
<li>Basic R</li>
<li>Data manipulation</li>
<li>Reporting (time permitting)</li>
</ol>
</div>
</div>
</div>
<div id="outline-container-orga4705d3" class="outline-2">
<h2 id="orga4705d3"><span class="section-number-2">2</span> What is R?</h2>
<div class="outline-text-2" id="text-2">
</div><div id="outline-container-orgfec30d7" class="outline-3">
<h3 id="orgfec30d7"><span class="section-number-3">2.1</span> What is R?</h3>
<div class="outline-text-3" id="text-2-1">
<ul class="org-ul">
<li>This is a course about R&#x2026;  <i>mais qu&rsquo;est-ce que c&rsquo;est</i>?</li>
<li>&ldquo;R is a language and environment for statistical computing and graphics&rdquo;</li>
<li>Derived from S, designed at Bell Laboratories
<ul class="org-ul">
<li>S first appeared in 1976!</li>
</ul></li>
<li><i>R is a language</i> &#x2026; so be prepared for it to hurt a bit to learn!</li>
</ul>
</div>
</div>
<div id="outline-container-orged476a2" class="outline-3">
<h3 id="orged476a2"><span class="section-number-3">2.2</span> Advantages of R</h3>
<div class="outline-text-3" id="text-2-2">
<ul class="org-ul">
<li>Free</li>
<li>Open-source</li>
<li>Available on nearly every platform</li>
<li>Extensible via <b>packages</b> &#x2014; CRAN has over 10,000</li>
<li>Great community</li>
</ul>
</div>
</div>
<div id="outline-container-org95a7221" class="outline-3">
<h3 id="org95a7221"><span class="section-number-3">2.3</span> Running code</h3>
<div class="outline-text-3" id="text-2-3">
<ul class="org-ul">
<li>How to use this R thing?</li>
<li>If you have R and Rstudio installed, open Rstudio.</li>
<li>You should see three panes.</li>
<li>We&rsquo;ll focus for now on the console, which is on the left and should look something like this:</li>
</ul>
</div>
</div>
<div id="outline-container-org5450fb2" class="outline-3">
<h3 id="org5450fb2"><span class="section-number-3">2.4</span> The console</h3>
<div class="outline-text-3" id="text-2-4">
<pre class="example">
R version 3.4.0 (2017-06-15) -- "You Stupid Darkness"
Copyright (C) 2017 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

[ ... ]

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

&gt;
</pre>
</div>
</div>
<div id="outline-container-org7e2ad5e" class="outline-3">
<h3 id="org7e2ad5e"><span class="section-number-3">2.5</span> R is a big giant calculator</h3>
<div class="outline-text-3" id="text-2-5">
<ul class="org-ul">
<li>R can do math</li>
<li>Really, really fancy math</li>
<li>Try typing <code>3 + 3</code> in the console</li>
<li>After pressing enter, R will return <code>6</code></li>
<li>R understands the order of operations 
<ul class="org-ul">
<li><code>3 + 3 * 9</code> is different from <code>(3 + 3) * 9</code></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-orgcb17971" class="outline-3">
<h3 id="orgcb17971"><span class="section-number-3">2.6</span> A quiz</h3>
<div class="outline-text-3" id="text-2-6">
<ul class="org-ul">
<li>Time for a quiz!</li>
<li>What&rsquo;s 7 times 149?</li>
<li>What&rsquo;s the square root of the previous answer?</li>
<li><b>Tip:</b> You can hit the up arrow to get whatever you entered last</li>
</ul>
</div>
</div>
<div id="outline-container-org53ff44b" class="outline-3">
<h3 id="org53ff44b"><span class="section-number-3">2.7</span> Answers</h3>
<div class="outline-text-3" id="text-2-7">
<div class="org-src-container">
<pre class="src src-R"><span style="color: #a45bad;">7</span> * <span style="color: #a45bad;">149</span>
</pre>
</div>

<pre class="example">
[1] 1043

</pre>

<div class="org-src-container">
<pre class="src src-R">(<span style="color: #a45bad;">7</span> * <span style="color: #a45bad;">149</span>) ^ (<span style="color: #a45bad;">1</span> / <span style="color: #a45bad;">2</span>)
</pre>
</div>

<pre class="example">
[1] 32.29551

</pre>
</div>
</div>

<div id="outline-container-org1f729cc" class="outline-3">
<h3 id="org1f729cc"><span class="section-number-3">2.8</span> Packages</h3>
<div class="outline-text-3" id="text-2-8">
<ul class="org-ul">
<li>At this point, please install a few packages. You&rsquo;ll need an internet connection.</li>
<li><code>install.packages(c("tidyverse", "gapminder"))</code>
<ul class="org-ul">
<li>If you have already installed some packages, make sure they&rsquo;re up-to-date:
<ul class="org-ul">
<li><code>update.packages()</code></li>
</ul></li>
</ul></li>
<li><b>Tip:</b> just type <code>ins</code> then hit TAB for tab-completion</li>
<li>Don&rsquo;t worry about what is going on here, I&rsquo;ll explain it later.</li>
<li>Depending on your exact setup, R may ask you a few questions about using a personal library. Do so.</li>
<li>If you get an error, make sure you can access the internet (<a href="https://cloud.r-project.org">https://cloud.r-project.org</a> in particular)</li>
</ul>
</div>
</div>
<div id="outline-container-org2637ceb" class="outline-3">
<h3 id="org2637ceb"><span class="section-number-3">2.9</span> R scripts</h3>
<div class="outline-text-3" id="text-2-9">
<ul class="org-ul">
<li>While those packages are installing, let&rsquo;s go ahead and open up an R script.</li>
<li>Allows you to save code so it doesn&rsquo;t disappear into the ether</li>
<li>If using Rstudio, File, new file, R script (or Ctrl+shift+n)</li>
<li><b>Tip</b>: can send a line from R script to console for evaluation using ctrl+enter</li>
<li><b>Strongly recommend</b> that you type into a script and use a keyboard shortcut to evaluate code
<ul class="org-ul">
<li>Easier to edit &amp; rerun</li>
<li>Allows you to save code</li>
<li>You may make comments</li>
</ul></li>
</ul>
<div class="org-src-container">
<pre class="src src-R"><span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">This adds 3 + 3</span>
<span style="color: #a45bad;">3</span> + <span style="color: #a45bad;">3</span>
<span style="color: #a45bad;">3</span> * <span style="color: #a45bad;">2</span> <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">same</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org9db14af" class="outline-2">
<h2 id="org9db14af"><span class="section-number-2">3</span> Graphics in R</h2>
<div class="outline-text-2" id="text-3">
</div><div id="outline-container-org79cb872" class="outline-3">
<h3 id="org79cb872"><span class="section-number-3">3.1</span> Data Analysis with R</h3>
<div class="outline-text-3" id="text-3-1">
<ul class="org-ul">
<li>We need some data to work with</li>
</ul>
<ul class="org-ul">
<li>We&rsquo;re going to use some data that comes with the <code>gapminder</code> package you just installed</li>
</ul>
<ul class="org-ul">
<li>To access the data, you need to load it into memory:</li>
</ul>
<div class="org-src-container">
<pre class="src src-R"><span style="color: #a45bad;">library</span>(gapminder)
</pre>
</div>
</div>
</div>
<div id="outline-container-org1802de9" class="outline-3">
<h3 id="org1802de9"><span class="section-number-3">3.2</span> Exploring our data</h3>
<div class="outline-text-3" id="text-3-2">
<ul class="org-ul">
<li><code>gapminder</code> is a <b>data.frame</b></li>
</ul>
<ul class="org-ul">
<li>Can get a sense of what it looks like with some <b>functions</b></li>
</ul>
<ul class="org-ul">
<li>Let&rsquo;s get a sense of what <code>gapminder</code> has:</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">View(gapminder)
</pre>
</div>
<div class="org-src-container">
<pre class="src src-R">head(gapminder)
</pre>
</div>

<pre class="example">
      country continent year lifeExp      pop gdpPercap
1 Afghanistan      Asia 1952  28.801  8425333  779.4453
2 Afghanistan      Asia 1957  30.332  9240934  820.8530
3 Afghanistan      Asia 1962  31.997 10267083  853.1007
4 Afghanistan      Asia 1967  34.020 11537966  836.1971
5 Afghanistan      Asia 1972  36.088 13079460  739.9811
6 Afghanistan      Asia 1977  38.438 14880372  786.1134

</pre>
</div>
</div>

<div id="outline-container-orgba145d8" class="outline-3">
<h3 id="orgba145d8"><span class="section-number-3">3.3</span> Descriptive statistics</h3>
<div class="outline-text-3" id="text-3-3">
<ul class="org-ul">
<li>R has lots of built-in functions for getting a sense of the data.</li>
<li>Try running <code>summary(gapminder)</code></li>
<li>What&rsquo;s the average life expectancy?</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">summary(gapminder)
</pre>
</div>

<pre class="example">
       country        continent        year         lifeExp           pop           
Afghanistan:  12   Africa  :624   Min.   :1952   Min.   :23.60   Min.   :6.001e+04  
Albania    :  12   Americas:300   1st Qu.:1966   1st Qu.:48.20   1st Qu.:2.794e+06  
Algeria    :  12   Asia    :396   Median :1980   Median :60.71   Median :7.024e+06  
Angola     :  12   Europe  :360   Mean   :1980   Mean   :59.47   Mean   :2.960e+07  
Argentina  :  12   Oceania : 24   3rd Qu.:1993   3rd Qu.:70.85   3rd Qu.:1.959e+07  
Australia  :  12                  Max.   :2007   Max.   :82.60   Max.   :1.319e+09  
(Other)    :1632                                                                    
  gdpPercap       
Min.   :   241.2  
1st Qu.:  1202.1  
Median :  3531.8  
Mean   :  7215.3  
3rd Qu.:  9325.5  
Max.   :113523.1
</pre>
</div>
</div>

<div id="outline-container-orgaab71fb" class="outline-3">
<h3 id="orgaab71fb"><span class="section-number-3">3.4</span> Graphics in R</h3>
<div class="outline-text-3" id="text-3-4">
<ul class="org-ul">
<li>Let&rsquo;s start making graphs</li>
<li>This is the fun part!</li>
<li>We&rsquo;re going to rely on the `ggplot2` package, which we installed earlier (as a part of the tidyverse package)</li>
<li>&ldquo;The Grammar of Graphics&rdquo;</li>
<li>load it up with</li>
</ul>
<div class="org-src-container">
<pre class="src src-R"><span style="color: #a45bad;">library</span>(ggplot2)
</pre>
</div>
</div>
</div>
<div id="outline-container-orgdb960e7" class="outline-3">
<h3 id="orgdb960e7"><span class="section-number-3">3.5</span> Our question</h3>
<div class="outline-text-3" id="text-3-5">
<blockquote>
<p>
What&rsquo;s the relationship between wealth (gdp) and average life expectancy?
</p>
</blockquote>
<ul class="org-ul">
<li>Scatterplot is a good way to get started looking at data!</li>
</ul>
</div>
</div>
<div id="outline-container-org8dcc970" class="outline-3">
<h3 id="org8dcc970"><span class="section-number-3">3.6</span> ggplot2</h3>
<div class="outline-text-3" id="text-3-6">
<ul class="org-ul">
<li>Use the <code>ggplot()</code> function to start a plot.</li>
<li>The first <i>argument</i> is to tell it the <i>data</i></li>
<li><b>Tip:</b> use <code>?ggplot</code> to look at the help page, where you can see the names of the arguments</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">ggplot(data = gapminder) <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Please use gapminder data</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org01fe255" class="outline-3">
<h3 id="org01fe255"><span class="section-number-3">3.7</span> <code>geom_point</code></h3>
<div class="outline-text-3" id="text-3-7">
<ul class="org-ul">
<li><code>ggplot()</code> by itself is pretty useless, it just starts a plot</li>
<li>We then have to tell <code>ggplot</code> what to draw!</li>
<li><b>Tip:</b> <code>?geom_point</code></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">ggplot(data = gapminder) +
  geom_point(mapping = aes(x = gdpPercap, <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Put gdp on x axis</span>
                           y = lifeExp))  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Put lifeExp on y</span>

</pre>
</div>
</div>
</div>
<div id="outline-container-org265d8bc" class="outline-3">
<h3 id="org265d8bc"><span class="section-number-3">3.8</span> </h3>
<div class="outline-text-3" id="text-3-8">
<p>
<a href="figures/gdp-life.pdf">figures/gdp-life.pdf</a>
</p>
</div>
</div>
<div id="outline-container-org6ba10c6" class="outline-3">
<h3 id="org6ba10c6"><span class="section-number-3">3.9</span> Fix that x axis!</h3>
<div class="outline-text-3" id="text-3-9">
<ul class="org-ul">
<li>Is there a better way to show this relationship?</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">ggplot(data = gapminder) +
  geom_point(mapping = aes(x = log(gdpPercap), <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Log x-axis</span>
                           y = lifeExp))
</pre>
</div>
</div>
</div>
<div id="outline-container-orgeed618b" class="outline-3">
<h3 id="orgeed618b"><span class="section-number-3">3.10</span> </h3>
<div class="outline-text-3" id="text-3-10">
<p>
<a href="figures/gdp-life-logx.pdf">figures/gdp-life-logx.pdf</a>
</p>
</div>
</div>
<div id="outline-container-org1f2d4a3" class="outline-3">
<h3 id="org1f2d4a3"><span class="section-number-3">3.11</span> Aesthetics</h3>
<div class="outline-text-3" id="text-3-11">
<ul class="org-ul">
<li><code>ggplot()</code> creates a coordinate system</li>
</ul>
<ul class="org-ul">
<li>You can then add one or more layers to this to create a plot</li>
</ul>
<ul class="org-ul">
<li>We just added the <code>geom_point()</code> layer, which used the <code>x</code> and <code>y</code> aesthetics (<code>aes</code>) to add a layer of points to our plot</li>
</ul>
<ul class="org-ul">
<li>We can add more information to the aesthetics to convey more information like color, shape, and size.</li>
</ul>
<ul class="org-ul">
<li>Example: What if we want to convey info about relationship between wealth and life expectancy by continent?</li>
</ul>
<ul class="org-ul">
<li>One solution: add color by continent</li>
</ul>
</div>
</div>
<div id="outline-container-orgdce8496" class="outline-3">
<h3 id="orgdce8496"><span class="section-number-3">3.12</span> Color</h3>
<div class="outline-text-3" id="text-3-12">
<div class="org-src-container">
<pre class="src src-R">ggplot(data = gapminder) +
  geom_point(mapping = aes(x = log(gdpPercap),
                           y = lifeExp,
                           <span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">colour for the Brits</span>
                           color = continent)) 
</pre>
</div>
</div>
</div>
<div id="outline-container-org7769836" class="outline-3">
<h3 id="org7769836"><span class="section-number-3">3.13</span> </h3>
<div class="outline-text-3" id="text-3-13">
<p>
<a href="figures/gdp-life-continent-color.pdf">figures/gdp-life-continent-color.pdf</a>
</p>
</div>
</div>
<div id="outline-container-org9a1e39f" class="outline-3">
<h3 id="org9a1e39f"><span class="section-number-3">3.14</span> Multiple aesthetics - color &amp; shape</h3>
<div class="outline-text-3" id="text-3-14">
<ul class="org-ul">
<li>Of course, some people are colorblind, and others don&rsquo;t print things in color, so may be nice to use something like shape in addition:</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">ggplot(gapminder) +
  geom_point(aes(x = log(gdpPercap),
                 y = lifeExp,
                 color = continent, 
                 shape = continent))
</pre>
</div>
</div>
</div>
<div id="outline-container-org1ebbc61" class="outline-3">
<h3 id="org1ebbc61"><span class="section-number-3">3.15</span> </h3>
<div class="outline-text-3" id="text-3-15">
<p>
<a href="figures/gdp-life-continent-shape.pdf">figures/gdp-life-continent-shape.pdf</a>
</p>
</div>
</div>
<div id="outline-container-org3aca071" class="outline-3">
<h3 id="org3aca071"><span class="section-number-3">3.16</span> More about aesthetics</h3>
<div class="outline-text-3" id="text-3-16">
<ul class="org-ul">
<li>There are more aesthetic mappings</li>
<li>Try <code>size</code>, and <code>alpha</code> (transparency) for yourself</li>
</ul>
<ul class="org-ul">
<li>You can set aesthetics directly by mapping the aesthetic to a value <b><i>outside</i></b> the call to <code>aes()</code></li>
<li>For example, we may want to make the dots slightly transparent to avoid overplotting</li>
</ul>
</div>
</div>
<div id="outline-container-orge34bd8d" class="outline-3">
<h3 id="orge34bd8d"><span class="section-number-3">3.17</span> Aesthetics not mapped to variable</h3>
<div class="outline-text-3" id="text-3-17">
<div class="org-src-container">
<pre class="src src-R">ggplot(data = gapminder) +
  geom_point(mapping = aes(x = log(gdpPercap),
                           y = lifeExp,
                           color = continent),
             alpha = <span style="color: #a45bad;">0.5</span>)
</pre>
</div>
</div>
</div>
<div id="outline-container-org13c1371" class="outline-3">
<h3 id="org13c1371"><span class="section-number-3">3.18</span> </h3>
<div class="outline-text-3" id="text-3-18">
<p>
<a href="figures/gdp-life-transparent.pdf">figures/gdp-life-transparent.pdf</a>
</p>
</div>
</div>

<div id="outline-container-orgfc7be00" class="outline-3">
<h3 id="orgfc7be00"><span class="section-number-3">3.19</span> Facets</h3>
<div class="outline-text-3" id="text-3-19">
<ul class="org-ul">
<li>So we can use aesthetics to add variables to our graph like <code>color</code>.</li>
<li>We might also want to add variables by splitting up the graph based on values of another variables &#x2014; e.g. subfigures</li>
<li>If we want to use just one variable, use <code>facet_wrap()</code></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">ggplot(data = gapminder) +
  geom_point(mapping = aes(x = log(gdpPercap),
                           y = lifeExp)) +
  facet_wrap( ~ continent, nrow = <span style="color: #a45bad;">2</span>)
</pre>
</div>
</div>
</div>
<div id="outline-container-org20e6805" class="outline-3">
<h3 id="org20e6805"><span class="section-number-3">3.20</span> </h3>
<div class="outline-text-3" id="text-3-20">
<p>
<a href="figures/gdp-life-facet-continent.pdf">figures/gdp-life-facet-continent.pdf</a>
</p>
</div>
</div>
<div id="outline-container-org5e9c5fc" class="outline-3">
<h3 id="org5e9c5fc"><span class="section-number-3">3.21</span> Facets with two variables</h3>
<div class="outline-text-3" id="text-3-21">
<ul class="org-ul">
<li>ggplot can facet with two variables with one by row and the other by column</li>
<li>Use <code>facet_grid(row ~ column)</code> to do so</li>
<li>Our <code>gapminder</code> data aren&rsquo;t very well suited for this, but you could do something like:</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">ggplot(data = gapminder) +
  geom_point(mapping = aes(x = log(gdpPercap),
                           y = lifeExp)) +
  <span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">year &gt;= 2000 will be TRUE or FALSE; </span>
  <span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">we'll learn more about logical statements later on:</span>
  facet_grid(year &gt;= <span style="color: #a45bad;">2000</span> ~ continent)  
</pre>
</div>
</div>
</div>
<div id="outline-container-orgbaa3889" class="outline-3">
<h3 id="orgbaa3889"><span class="section-number-3">3.22</span> </h3>
<div class="outline-text-3" id="text-3-22">
<p>
<a href="figures/gdp-life-facet-continent-post2000.pdf">figures/gdp-life-facet-continent-post2000.pdf</a>
</p>
</div>
</div>
<div id="outline-container-org7493dc2" class="outline-3">
<h3 id="org7493dc2"><span class="section-number-3">3.23</span> ggplot</h3>
<div class="outline-text-3" id="text-3-23">
<ul class="org-ul">
<li>Review of what we&rsquo;ve learned so far:
<ul class="org-ul">
<li><code>ggplot()</code> creates a blank coordinate system</li>
</ul></li>
</ul>
<ul class="org-ul">
<li><code>aes()</code> helps us map variables to visual properties (x/y location, color, shape, etc)</li>
</ul>
<ul class="org-ul">
<li><code>facet_wrap()</code> and <code>facet_grid()</code> help us convey variables via subfigures</li>
</ul>
<ul class="org-ul">
<li>But what about plots other than the scatterplot?</li>
</ul>
</div>
</div>
<div id="outline-container-org787ee6e" class="outline-3">
<h3 id="org787ee6e"><span class="section-number-3">3.24</span> geoms</h3>
<div class="outline-text-3" id="text-3-24">
<ul class="org-ul">
<li>A <code>geom</code> (geometrical object) is <code>ggplot</code>&rsquo;s way of representing data</li>
</ul>
<ul class="org-ul">
<li>We&rsquo;ve been using <code>geom_point()</code> to represent data as points, e.g. a scatterplot</li>
<li>A <code>geom</code> is (usually) the thing we call the plot - line plots, bar plots, boxplots, etc</li>
</ul>
<ul class="org-ul">
<li>Let&rsquo;s plot the same relationship between wealth and life expectancy but using <code>geom_smooth()</code> rather than <code>geom_point()</code>:</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">ggplot(data = gapminder) +
  geom_smooth(mapping = aes(x = log(gdpPercap),
                            y = lifeExp)) 

</pre>
</div>
</div>
</div>
<div id="outline-container-orgfe445a7" class="outline-3">
<h3 id="orgfe445a7"><span class="section-number-3">3.25</span> </h3>
<div class="outline-text-3" id="text-3-25">
<p>
<a href="figures/gdp-life-smooth.pdf">figures/gdp-life-smooth.pdf</a>
</p>
</div>
</div>
<div id="outline-container-orgcf1c12b" class="outline-3">
<h3 id="orgcf1c12b"><span class="section-number-3">3.26</span> geoms</h3>
<div class="outline-text-3" id="text-3-26">
<ul class="org-ul">
<li>Hey, that last plot looked pretty linear</li>
<li>We can use OLS instead:</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">ggplot(data = gapminder) +
  geom_smooth(mapping = aes(x = log(gdpPercap),
                            y = lifeExp),
              method = <span style="color: #2d9574;">"lm"</span>)

</pre>
</div>
</div>
</div>
<div id="outline-container-org245ae05" class="outline-3">
<h3 id="org245ae05"><span class="section-number-3">3.27</span> </h3>
<div class="outline-text-3" id="text-3-27">
<p>
<a href="figures/gdp-life-smooth-lm.pdf">figures/gdp-life-smooth-lm.pdf</a>
</p>
</div>
</div>
<div id="outline-container-org939fa1b" class="outline-3">
<h3 id="org939fa1b"><span class="section-number-3">3.28</span> geoms and aesthetics</h3>
<div class="outline-text-3" id="text-3-28">
<ul class="org-ul">
<li>Note that different aesthetics are available for different geoms</li>
</ul>
<ul class="org-ul">
<li>So while <code>linetype</code> didn&rsquo;t really make sense for our scatterplot, it makes total sense for a line:</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">ggplot(data = gapminder) +
  geom_smooth(mapping = aes(x = log(gdpPercap),
                            y = lifeExp,
                            color = continent,
                            linetype = continent),
              method = <span style="color: #2d9574;">"lm"</span>)

</pre>
</div>
</div>
</div>
<div id="outline-container-org928e715" class="outline-3">
<h3 id="org928e715"><span class="section-number-3">3.29</span> </h3>
<div class="outline-text-3" id="text-3-29">
<p>
<a href="figures/gdp-life-smooth-continent.pdf">figures/gdp-life-smooth-continent.pdf</a>
</p>
</div>
</div>
<div id="outline-container-orge9d7e56" class="outline-3">
<h3 id="orge9d7e56"><span class="section-number-3">3.30</span> multiple geoms</h3>
<div class="outline-text-3" id="text-3-30">
<ul class="org-ul">
<li>To add multiple geoms, just add them one after the other:</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">ggplot(data = gapminder) +
  geom_smooth(mapping = aes(x = log(gdpPercap),
                            y = lifeExp)) +
  geom_point(mapping = aes(x = log(gdpPercap),
                           y = lifeExp))


</pre>
</div>
</div>
</div>
<div id="outline-container-org76576cf" class="outline-3">
<h3 id="org76576cf"><span class="section-number-3">3.31</span> </h3>
<div class="outline-text-3" id="text-3-31">
<p>
<a href="figures/gdp-life-smooth-point.pdf">figures/gdp-life-smooth-point.pdf</a>
</p>
</div>
</div>
<div id="outline-container-org04e4047" class="outline-3">
<h3 id="org04e4047"><span class="section-number-3">3.32</span> inherit aes</h3>
<div class="outline-text-3" id="text-3-32">
<ul class="org-ul">
<li>Instead of retyping the <code>aes</code> mapping, we can specify a set of defaults in the <code>ggplot()</code> call, and overwrite (or add) then in each <code>geom</code> call:</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">ggplot(data = gapminder,
       mapping = aes(x = log(gdpPercap),
                     y = lifeExp)) +
  geom_smooth() +
  geom_point(mapping = aes(color = continent))
</pre>
</div>
</div>
</div>
<div id="outline-container-org7240e7a" class="outline-3">
<h3 id="org7240e7a"><span class="section-number-3">3.33</span> </h3>
<div class="outline-text-3" id="text-3-33">
<p>
<a href="figures/gdp-life-smooth-point-color.pdf">figures/gdp-life-smooth-point-color.pdf</a>
</p>
</div>
</div>
<div id="outline-container-org867a3f0" class="outline-3">
<h3 id="org867a3f0"><span class="section-number-3">3.34</span> Review</h3>
<div class="outline-text-3" id="text-3-34">
<ul class="org-ul">
<li>ggplot2 provides a very flexible way to make high-quality graphics</li>
<li>stuff we didn&rsquo;t look at:
<ul class="org-ul">
<li>Lots of different geoms</li>
<li>Changing scales</li>
<li>Position</li>
<li>How to save to include in your paper (later, I promise!)</li>
</ul></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org1340bc5" class="outline-2">
<h2 id="org1340bc5"><span class="section-number-2">4</span> Basic R</h2>
<div class="outline-text-2" id="text-4">
</div><div id="outline-container-org5062ecc" class="outline-3">
<h3 id="org5062ecc"><span class="section-number-3">4.1</span> Basics</h3>
<div class="outline-text-3" id="text-4-1">
<ul class="org-ul">
<li>We skipped all of this because plotting is more fun &amp; I wanted to start with something fun</li>
<li>Let&rsquo;s talk about basic R</li>
</ul>
</div>
</div>
<div id="outline-container-orgfd44869" class="outline-3">
<h3 id="orgfd44869"><span class="section-number-3">4.2</span> Calculator</h3>
<div class="outline-text-3" id="text-4-2">
<ul class="org-ul">
<li>Remember R can be a calculator:</li>
</ul>
<div class="org-src-container">
<pre class="src src-R"><span style="color: #a45bad;">3</span> * <span style="color: #a45bad;">3</span> + <span style="color: #a45bad;">29</span> ^ <span style="color: #a45bad;">4</span> + <span style="color: #a45bad;">7</span>
</pre>
</div>

<pre class="example">
[1] 707297

</pre>

<ul class="org-ul">
<li>But R doesn&rsquo;t &ldquo;remember&rdquo; the answer to that anywhere</li>
</ul>
<ul class="org-ul">
<li>You must <i>assign</i> the output to an object in order for R to remember it:</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">x <span style="color: #a45bad;">&lt;-</span> <span style="color: #a45bad;">3</span> * <span style="color: #a45bad;">3</span> + <span style="color: #a45bad;">29</span> ^ <span style="color: #a45bad;">4</span> + <span style="color: #a45bad;">7</span>
my_name <span style="color: #a45bad;">&lt;-</span> <span style="color: #2d9574;">"Alex Branham"</span>
</pre>
</div>
<ul class="org-ul">
<li><b>Tip</b>: In Rstudio, use alt+- (option+-) to get <code>&lt;-</code></li>
</ul>
</div>
</div>
<div id="outline-container-orge17a301" class="outline-3">
<h3 id="orge17a301"><span class="section-number-3">4.3</span> Wait, what?</h3>
<div class="outline-text-3" id="text-4-3">
<ul class="org-ul">
<li>Yeah, I just assigned letters to an object</li>
</ul>
<ul class="org-ul">
<li>We can inspect the contents of an object by typing it into the R console:</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">x
</pre>
</div>

<pre class="example">
[1] 707297

</pre>

<ul class="org-ul">
<li>Here, type <code>my_</code> then hit tab to have autocompletion</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">my_name
</pre>
</div>

<pre class="example">
[1] "Alex Branham"

</pre>
</div>
</div>

<div id="outline-container-orga2cdafb" class="outline-3">
<h3 id="orga2cdafb"><span class="section-number-3">4.4</span> +</h3>
<div class="outline-text-3" id="text-4-4">
<ul class="org-ul">
<li>If you forgot the closing <code>"</code> &#x2014;  <code>my_name &lt;- "Alex Branham</code></li>
<li>The R prompt will change from <code>&gt;</code> to <code>+</code></li>
<li>This indicates that R is waiting for you.</li>
<li>Cancel by mashing <code>ESC</code></li>
</ul>
</div>
</div>
<div id="outline-container-orga7861aa" class="outline-3">
<h3 id="orga7861aa"><span class="section-number-3">4.5</span> R is pedantic</h3>
<div class="outline-text-3" id="text-4-5">
<ul class="org-ul">
<li>You have to be really specific with R:</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">x
</pre>
</div>

<pre class="example">
[1] 707297

</pre>

<div class="org-src-container">
<pre class="src src-R">X
</pre>
</div>

<pre class="example">
Error: object 'X' not found

</pre>

<div class="org-src-container">
<pre class="src src-R">my_nam
</pre>
</div>

<pre class="example">
Error: object 'my_nam' not found

</pre>
</div>
</div>

<div id="outline-container-org3c51b43" class="outline-3">
<h3 id="org3c51b43"><span class="section-number-3">4.6</span> Things don&rsquo;t happen magically</h3>
<div class="outline-text-3" id="text-4-6">
<div class="org-src-container">
<pre class="src src-R">x
</pre>
</div>

<pre class="example">
[1] 707297

</pre>

<div class="org-src-container">
<pre class="src src-R">x / <span style="color: #a45bad;">1000</span>
</pre>
</div>

<pre class="example">
[1] 707.297

</pre>

<div class="org-src-container">
<pre class="src src-R">x
</pre>
</div>

<pre class="example">
[1] 707297

</pre>
</div>
</div>

<div id="outline-container-orgb8a31b8" class="outline-3">
<h3 id="orgb8a31b8"><span class="section-number-3">4.7</span> Missing values</h3>
<div class="outline-text-3" id="text-4-7">
<ul class="org-ul">
<li>Missing data is represented by <code>NA</code> in R</li>
<li>R thinks about this as &ldquo;something that&rsquo;s there, but whose value we do not know&rdquo;</li>
<li>Missingness propagates</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">mean(c(<span style="color: #a45bad;">1</span>, <span style="color: #a45bad;">2</span>, <span style="color: #ce537a; font-weight: bold;">NA</span>))
</pre>
</div>

<pre class="example">
[1] NA

</pre>
</div>
</div>

<div id="outline-container-orgea56ae9" class="outline-3">
<h3 id="orgea56ae9"><span class="section-number-3">4.8</span> Missingness quiz</h3>
<div class="outline-text-3" id="text-4-8">
<ul class="org-ul">
<li>What will be the result?</li>
<li>We&rsquo;ll learn more about logical statements in a bit, this asks &ldquo;Is 3 equal to NA&rdquo;?</li>
</ul>
<div class="org-src-container">
<pre class="src src-R"><span style="color: #a45bad;">3</span> == <span style="color: #ce537a; font-weight: bold;">NA</span>
<span style="color: #ce537a; font-weight: bold;">NA</span> == <span style="color: #ce537a; font-weight: bold;">NA</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org48e2f11" class="outline-3">
<h3 id="org48e2f11"><span class="section-number-3">4.9</span> Missingness quiz answer</h3>
<div class="outline-text-3" id="text-4-9">
<div class="org-src-container">
<pre class="src src-R"><span style="color: #a45bad;">3</span> == <span style="color: #ce537a; font-weight: bold;">NA</span>
</pre>
</div>

<pre class="example">
[1] NA

</pre>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #ce537a; font-weight: bold;">NA</span> == <span style="color: #ce537a; font-weight: bold;">NA</span>
</pre>
</div>

<pre class="example">
[1] NA

</pre>
</div>
</div>

<div id="outline-container-orgbfa9d70" class="outline-3">
<h3 id="orgbfa9d70"><span class="section-number-3">4.10</span> Functions</h3>
<div class="outline-text-3" id="text-4-10">
<ul class="org-ul">
<li>Functions in R can take zero or more arguments</li>
</ul>
<pre class="example">
function(arg1 = object1, arg2 = object2, arg3 = object3)
</pre>
<div class="org-src-container">
<pre class="src src-R">my_vector <span style="color: #a45bad;">&lt;-</span> seq(from = <span style="color: #a45bad;">1</span>, to = <span style="color: #a45bad;">10</span>, by = <span style="color: #a45bad;">1</span>)
my_vector
</pre>
</div>

<pre class="example">
 
[1]  1  2  3  4  5  6  7  8  9 10

</pre>

<div class="org-src-container">
<pre class="src src-R">mean(x = my_vector)
</pre>
</div>

<pre class="example">
[1] 5.5

</pre>
</div>
</div>

<div id="outline-container-org0f35ca5" class="outline-3">
<h3 id="org0f35ca5"><span class="section-number-3">4.11</span> Functions, continued</h3>
<div class="outline-text-3" id="text-4-11">
<div class="org-src-container">
<pre class="src src-R">my_vector <span style="color: #a45bad;">&lt;-</span> c(<span style="color: #a45bad;">1</span>, <span style="color: #a45bad;">2</span>, <span style="color: #a45bad;">3</span>, <span style="color: #ce537a; font-weight: bold;">NA</span>, <span style="color: #ce537a; font-weight: bold;">NA</span>, <span style="color: #ce537a; font-weight: bold;">NA</span>, <span style="color: #a45bad;">3</span>, <span style="color: #a45bad;">2</span>, <span style="color: #a45bad;">1</span>)
mean(x = my_vector)
</pre>
</div>

<pre class="example">
[1] NA

</pre>

<div class="org-src-container">
<pre class="src src-R">mean(x = my_vector, na.rm = <span style="color: #ce537a; font-weight: bold;">TRUE</span>)
</pre>
</div>

<pre class="example">
[1] 2

</pre>
</div>
</div>

<div id="outline-container-orge008f0c" class="outline-3">
<h3 id="orge008f0c"><span class="section-number-3">4.12</span> Function arguments</h3>
<div class="outline-text-3" id="text-4-12">
<ul class="org-ul">
<li>You don&rsquo;t have to specify argument names if you type them in order.</li>
<li>Since <code>x</code> is the first argument of <code>mean()</code>, no need to type <code>mean(x = my_vector)</code></li>
<li>Instead, can just type <code>mean(my_vector)</code></li>
<li>This cuts down on the amount you have to type</li>
</ul>
</div>
</div>
<div id="outline-container-orgae4cd01" class="outline-3">
<h3 id="orgae4cd01"><span class="section-number-3">4.13</span> Data</h3>
<div class="outline-text-3" id="text-4-13">
<ul class="org-ul">
<li>OK, so now we know how to assign stuff and functions</li>
<li>Let&rsquo;s learn about how R thinks about data
<ul class="org-ul">
<li>&ldquo;data&rdquo; here doesn&rsquo;t have to mean data from e.g. a survey</li>
</ul></li>
<li>R cares about the <b>class</b> (type) of data and its <b>dimension(s)</b></li>
</ul>
</div>
</div>
<div id="outline-container-org0ceb617" class="outline-3">
<h3 id="org0ceb617"><span class="section-number-3">4.14</span> Data types</h3>
<div class="outline-text-3" id="text-4-14">
<ul class="org-ul">
<li>We&rsquo;ll discuss the four most common data types:
<ul class="org-ul">
<li>Numeric</li>
<li>Logical</li>
<li>Character</li>
<li>Factor</li>
</ul></li>
<li>We&rsquo;ll also cover <code>NA</code></li>
</ul>
</div>
</div>
<div id="outline-container-orgbbf1168" class="outline-3">
<h3 id="orgbbf1168"><span class="section-number-3">4.15</span> Numeric</h3>
<div class="outline-text-3" id="text-4-15">
<ul class="org-ul">
<li>Numeric is how R thinks about numbers!</li>
<li>These can also be called &ldquo;integer&rdquo; (if round numbers) or &ldquo;double&rdquo;</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">class(c(<span style="color: #a45bad;">1</span>, <span style="color: #a45bad;">2</span>, <span style="color: #a45bad;">3</span>))
</pre>
</div>

<pre class="example">
[1] "numeric"

</pre>

<div class="org-src-container">
<pre class="src src-R">sum(c(<span style="color: #a45bad;">1</span>, <span style="color: #a45bad;">2</span>, <span style="color: #a45bad;">3</span>))
</pre>
</div>

<pre class="example">
[1] 6

</pre>

<div class="org-src-container">
<pre class="src src-R">class(sum(c(<span style="color: #a45bad;">1</span>, <span style="color: #a45bad;">2</span>, <span style="color: #a45bad;">3</span>)))
</pre>
</div>

<pre class="example">
[1] "numeric"

</pre>
</div>
</div>

<div id="outline-container-org9a5e2ee" class="outline-3">
<h3 id="org9a5e2ee"><span class="section-number-3">4.16</span> Logical</h3>
<div class="outline-text-3" id="text-4-16">
<ul class="org-ul">
<li>Logical can take two values &#x2014; <code>TRUE</code> or <code>FALSE</code></li>
</ul>
<ul class="org-ul">
<li>This is useful for dummy variables and tests</li>
</ul>
<div class="org-src-container">
<pre class="src src-R"><span style="color: #a45bad;">1</span>:<span style="color: #a45bad;">10</span> &gt; <span style="color: #a45bad;">5</span>
</pre>
</div>

<pre class="example">
[1] FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE

</pre>
</div>
</div>

<div id="outline-container-org4f8814b" class="outline-3">
<h3 id="org4f8814b"><span class="section-number-3">4.17</span> Character</h3>
<div class="outline-text-3" id="text-4-17">
<ul class="org-ul">
<li>Characters represent text</li>
<li>Sometimes these are called &ldquo;strings&rdquo;</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">c(<span style="color: #2d9574;">"This"</span>, <span style="color: #2d9574;">"vector"</span>, <span style="color: #2d9574;">"is"</span>, <span style="color: #2d9574;">"of"</span>, <span style="color: #2d9574;">"length"</span>, <span style="color: #2d9574;">"what?"</span>)
c(<span style="color: #2d9574;">"How about this one?"</span>)
</pre>
</div>
</div>
</div>
<div id="outline-container-orgd55b479" class="outline-3">
<h3 id="orgd55b479"><span class="section-number-3">4.18</span> Factor</h3>
<div class="outline-text-3" id="text-4-18">
<ul class="org-ul">
<li>Factors are how R thinks about categorical variables</li>
</ul>
<ul class="org-ul">
<li>We already worked with these when we used the <code>continent</code> variable from <code>gapminder</code></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">head(gapminder$continent)
</pre>
</div>

<pre class="example">
[1] Asia Asia Asia Asia Asia Asia
Levels: Africa Americas Asia Europe Oceania

</pre>
</div>
</div>

<div id="outline-container-org57b2ffe" class="outline-3">
<h3 id="org57b2ffe"><span class="section-number-3">4.19</span> Data type quiz</h3>
<div class="outline-text-3" id="text-4-19">
<p>
What type of data are the following?
</p>
<div class="org-src-container">
<pre class="src src-R"><span style="color: #a45bad;">182</span>
c(<span style="color: #2d9574;">"My name is Alex"</span>)
<span style="color: #2d9574;">"TRUE"</span>
<span style="color: #ce537a; font-weight: bold;">FALSE</span>
c(<span style="color: #a45bad;">1</span>, <span style="color: #a45bad;">2</span>, <span style="color: #a45bad;">3</span>)
c(<span style="color: #a45bad;">1</span>, <span style="color: #2d9574;">"Alex"</span>, <span style="color: #ce537a; font-weight: bold;">TRUE</span>)
</pre>
</div>
</div>
</div>
<div id="outline-container-orgcad9320" class="outline-3">
<h3 id="orgcad9320"><span class="section-number-3">4.20</span> Data dimensions</h3>
<div class="outline-text-3" id="text-4-20">
<p>
What&rsquo;s the difference?
</p>
<pre class="example">
[1] 1 2 3 4 5 6

</pre>

<pre class="example">
     [,1] [,2]
[1,]    1    4
[2,]    2    5
[3,]    3    6

</pre>

<ul class="org-ul">
<li>Data can have <b>dimensions</b></li>
<li>Numeric, logical, character, and factors are single dimensions (so are lists)</li>
</ul>
<ul class="org-ul">
<li>That matrix is a 3 by 2 matrix</li>
<li>Why might we want to have two-dimensional data?</li>
</ul>
</div>
</div>
<div id="outline-container-org70b85c9" class="outline-3">
<h3 id="org70b85c9"><span class="section-number-3">4.21</span> The data.frame</h3>
<div class="outline-text-3" id="text-4-21">
<ul class="org-ul">
<li>Matrices must have the same type, but we can mix and match types with a <code>data.frame</code></li>
<li>Remember <code>gapminder</code> from earlier?</li>
<li>We used a <code>data.frame</code> to store columns with different data types</li>
</ul>
<ul class="org-ul">
<li>We can access (index, subset) <code>data.frame</code> objects using notation similar to matrix notation:</li>
</ul>
</div>
</div>
<div id="outline-container-orgd7dab64" class="outline-3">
<h3 id="orgd7dab64"><span class="section-number-3">4.22</span> Indexing data.frame</h3>
<div class="outline-text-3" id="text-4-22">
<div class="org-src-container">
<pre class="src src-R">gapminder[<span style="color: #a45bad;">2</span>, <span style="color: #a45bad;">1</span>] <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">get whatever is in the second row, 1st col</span>
gapminder[<span style="color: #a45bad;">1</span>, ]  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">get the first row (all)</span>
gapminder[, <span style="color: #a45bad;">1</span>]  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">get the first col (all)</span>
gapminder[, <span style="color: #2d9574;">"country"</span>] <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">select by name</span>
gapminder$country <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">slightly different</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org66258a2" class="outline-3">
<h3 id="org66258a2"><span class="section-number-3">4.23</span> Review</h3>
<div class="outline-text-3" id="text-4-23">
<ul class="org-ul">
<li>What we learned</li>
<li>Missingness propagates</li>
<li>Functions &amp; arguments</li>
<li>Basic vectors: numeric, logical, character, factor</li>
<li>Dimensions &amp; the data.frame</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org9b2ba02" class="outline-2">
<h2 id="org9b2ba02"><span class="section-number-2">5</span> Data import &amp; manipulation</h2>
<div class="outline-text-2" id="text-5">
</div><div id="outline-container-org0f47741" class="outline-3">
<h3 id="org0f47741"><span class="section-number-3">5.1</span> Importing data</h3>
<div class="outline-text-3" id="text-5-1">
<ul class="org-ul">
<li>Importing data in R is either trivially easy (usually) or super specific and difficult (rarely), so we won&rsquo;t actually be doing this</li>
</ul>
<ul class="org-ul">
<li>R has a lot of build in functions: <code>read.csv()</code>, <code>read.table()</code>, etc</li>
<li>Packages provide still more: <code>readr::read_csv()</code>, <code>haven::read_dta()</code>, etc</li>
</ul>
<ul class="org-ul">
<li>I prefer the <code>rio</code> package because I don&rsquo;t have to think</li>
<li>Always gives you a <code>data.frame</code>:</li>
</ul>
<div class="org-src-container">
<pre class="src src-R"><span style="color: #a45bad;">library</span>(rio)
csv_data <span style="color: #a45bad;">&lt;-</span> import(<span style="color: #2d9574;">"file.csv"</span>)
stata_data <span style="color: #a45bad;">&lt;-</span> import(<span style="color: #2d9574;">"file.dta"</span>)
</pre>
</div>
</div>
</div>
<div id="outline-container-org84b24bb" class="outline-3">
<h3 id="org84b24bb"><span class="section-number-3">5.2</span> Working directories &amp; project structure</h3>
<div class="outline-text-3" id="text-5-2">
<ul class="org-ul">
<li>R has the concept of a &ldquo;working directory&rdquo;</li>
<li>You can see where this is by typing <code>getwd()</code> into the console</li>
<li>I like to store data and code in separate folders:</li>
<li><b>Tip</b>: Rstudio can manage &ldquo;projects&rdquo; that take care of a lot of this</li>
</ul>
</div>
</div>
<div id="outline-container-orgdbbc126" class="outline-3">
<h3 id="orgdbbc126"><span class="section-number-3">5.3</span> Simple project structure</h3>
<div class="outline-text-3" id="text-5-3">
<pre class="example">
my-paper-project/
|--- code/
|    |--- my-script.R
|    |--- my-alt-script.R
|--- data/
|    |--- awesome-data.csv
|--- output/
|    |--- figure1.eps
|    |--- figure2.eps
|    |--- table1.tex
|    |--- table2.tex
|--- my-paper.tex
</pre>
</div>
</div>
<div id="outline-container-org0bce24d" class="outline-3">
<h3 id="org0bce24d"><span class="section-number-3">5.4</span> Relative paths</h3>
<div class="outline-text-3" id="text-5-4">
<ul class="org-ul">
<li>If you have code like that, you need to know what a relative path is so that code in your <code>code/</code> directory can load data in your <code>data/</code> directory!</li>
</ul>
<ul class="org-ul">
<li>So if we&rsquo;re running a file from <code>code/</code> (that&rsquo;s the working directory), we can load data by doing:</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">my_awesome_data <span style="color: #a45bad;">&lt;-</span> import(<span style="color: #2d9574;">"../data/awesome_data.csv"</span>)
</pre>
</div>
<ul class="org-ul">
<li>Two dots <code>..</code> says &ldquo;go up one directory&rdquo;, we could chain them to go up two: <code>../..</code></li>
</ul>
</div>
</div>
<div id="outline-container-org3ae34a8" class="outline-3">
<h3 id="org3ae34a8"><span class="section-number-3">5.5</span> dplyr</h3>
<div class="outline-text-3" id="text-5-5">
<ul class="org-ul">
<li>We are going to use dplyr, another package you&rsquo;ve installed, to help us transform data</li>
</ul>
<ul class="org-ul">
<li><code>filter()</code> drops rows based on columns</li>
<li><code>select()</code>  selects columns</li>
</ul>
<ul class="org-ul">
<li><code>mutate()</code>  creates new variables</li>
<li><code>summarize()</code> return statistics</li>
</ul>
<ul class="org-ul">
<li><code>group_by()</code> allows us to do the above by groups</li>
</ul>
<p>
-These functions take data as the first argument and always return a data.frame<sup><a id="fnr.1" class="footref" href="#fn.1">1</a></sup>
</p>
<div class="org-src-container">
<pre class="src src-R"><span style="color: #a45bad;">library</span>(dplyr)
</pre>
</div>
</div>
</div>
<div id="outline-container-org0e5ec19" class="outline-3">
<h3 id="org0e5ec19"><span class="section-number-3">5.6</span> <code>filter</code></h3>
<div class="outline-text-3" id="text-5-6">
<ul class="org-ul">
<li><code>filter()</code> uses logical statements (that are TRUE) to return rows:</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">filter(gapminder, continent == <span style="color: #2d9574;">"Asia"</span>)
filter(gapminder, continent == <span style="color: #2d9574;">"Asia"</span> &amp; year &gt;= <span style="color: #a45bad;">2000</span>)
filter(gapminder, continent == <span style="color: #2d9574;">"Asia"</span> &amp; year != <span style="color: #a45bad;">2000</span>)
filter(gapminder, continent == <span style="color: #2d9574;">"Asia"</span> | year == <span style="color: #a45bad;">2000</span>)
</pre>
</div>
</div>
</div>
<div id="outline-container-orgafd0e42" class="outline-3">
<h3 id="orgafd0e42"><span class="section-number-3">5.7</span> Quiz</h3>
<div class="outline-text-3" id="text-5-7">
<ul class="org-ul">
<li>Use filter to return all the rows containing observations from Asia or Africa</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">filter(gapminder, continent == <span style="color: #2d9574;">"Asia"</span> | continent == <span style="color: #2d9574;">"Africa"</span>)
filter(gapminder, continent <span style="color: #a45bad;">%in%</span> c(<span style="color: #2d9574;">"Asia"</span>, <span style="color: #2d9574;">"Africa"</span>))
</pre>
</div>
</div>
</div>
<div id="outline-container-org6ba77ac" class="outline-3">
<h3 id="org6ba77ac"><span class="section-number-3">5.8</span> <code>select</code></h3>
<div class="outline-text-3" id="text-5-8">
<ul class="org-ul">
<li>The <code>select</code> function selects one or more columns:</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">select(gapminder, country)
select(gapminder, country, year, continent)
select(gapminder, -continent)
</pre>
</div>
<ul class="org-ul">
<li>several helper functions (e.g. <code>starts_with</code>), see <code>?select</code> for examples</li>
</ul>
</div>
</div>
<div id="outline-container-org18fd76c" class="outline-3">
<h3 id="org18fd76c"><span class="section-number-3">5.9</span> <code>mutate</code></h3>
<div class="outline-text-3" id="text-5-9">
<ul class="org-ul">
<li>Mutate creates new variables:</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">mutate(gapminder, gdp = pop * gdpPercap)
</pre>
</div>

<pre class="example">
# A tibble: 1,704 x 7
       country continent  year lifeExp      pop gdpPercap         gdp
        &lt;fctr&gt;    &lt;fctr&gt; &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;       &lt;dbl&gt;
 1 Afghanistan      Asia  1952  28.801  8425333  779.4453  6567086330
 2 Afghanistan      Asia  1957  30.332  9240934  820.8530  7585448670
 3 Afghanistan      Asia  1962  31.997 10267083  853.1007  8758855797
 4 Afghanistan      Asia  1967  34.020 11537966  836.1971  9648014150
 5 Afghanistan      Asia  1972  36.088 13079460  739.9811  9678553274
 6 Afghanistan      Asia  1977  38.438 14880372  786.1134 11697659231
 7 Afghanistan      Asia  1982  39.854 12881816  978.0114 12598563401
 8 Afghanistan      Asia  1987  40.822 13867957  852.3959 11820990309
 9 Afghanistan      Asia  1992  41.674 16317921  649.3414 10595901589
10 Afghanistan      Asia  1997  41.763 22227415  635.3414 14121995875
# ... with 1,694 more rows
</pre>
</div>
</div>

<div id="outline-container-org0cba44e" class="outline-3">
<h3 id="org0cba44e"><span class="section-number-3">5.10</span> <code>summarize</code></h3>
<div class="outline-text-3" id="text-5-10">
<ul class="org-ul">
<li><code>summarize</code> (or <code>summarise</code> if you prefer) creates summary statistics:</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">summarize(gapminder, mean_life = mean(lifeExp))
</pre>
</div>

<pre class="example">
# A tibble: 1 x 1
  mean_life
      &lt;dbl&gt;
1  59.47444

</pre>

<ul class="org-ul">
<li>Though whoop-de-doo, we could&rsquo;ve just done <code>mean(gapminder$lifeExp)</code> to get that!</li>
</ul>
<ul class="org-ul">
<li>Much more useful if we do this by groups</li>
</ul>
</div>
</div>
<div id="outline-container-org63dce4e" class="outline-3">
<h3 id="org63dce4e"><span class="section-number-3">5.11</span> <code>group_by</code></h3>
<div class="outline-text-3" id="text-5-11">
<ul class="org-ul">
<li>All the functions we just learned can be performed by groups!</li>
<li>This is really exciting and makes life much easier</li>
<li>Calculate mean life expectancy by year:</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">summarize(group_by(gapminder, year), mean_life = mean(lifeExp))
<span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">Or, to add it to the data:</span>
mutate(group_by(gapminder, year), year_mean_life = mean(lifeExp))
</pre>
</div>

<pre class="example">
# A tibble: 12 x 2
    year mean_life
   &lt;int&gt;     &lt;dbl&gt;
 1  1952  49.05762
 2  1957  51.50740
 3  1962  53.60925
 4  1967  55.67829
 5  1972  57.64739
 6  1977  59.57016
 7  1982  61.53320
 8  1987  63.21261
 9  1992  64.16034
10  1997  65.01468
11  2002  65.69492
12  2007  67.00742
# A tibble: 1,704 x 7
# Groups:   year [12]
       country continent  year lifeExp      pop gdpPercap year_mean_life
        &lt;fctr&gt;    &lt;fctr&gt; &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;          &lt;dbl&gt;
 1 Afghanistan      Asia  1952  28.801  8425333  779.4453       49.05762
 2 Afghanistan      Asia  1957  30.332  9240934  820.8530       51.50740
 3 Afghanistan      Asia  1962  31.997 10267083  853.1007       53.60925
 4 Afghanistan      Asia  1967  34.020 11537966  836.1971       55.67829
 5 Afghanistan      Asia  1972  36.088 13079460  739.9811       57.64739
 6 Afghanistan      Asia  1977  38.438 14880372  786.1134       59.57016
 7 Afghanistan      Asia  1982  39.854 12881816  978.0114       61.53320
 8 Afghanistan      Asia  1987  40.822 13867957  852.3959       63.21261
 9 Afghanistan      Asia  1992  41.674 16317921  649.3414       64.16034
10 Afghanistan      Asia  1997  41.763 22227415  635.3414       65.01468
# ... with 1,694 more rows
</pre>
</div>
</div>

<div id="outline-container-org1e92920" class="outline-3">
<h3 id="org1e92920"><span class="section-number-3">5.12</span> <code>group_by</code>, continued</h3>
<div class="outline-text-3" id="text-5-12">
<ul class="org-ul">
<li>Calculate change in life expectancy by country:</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">mutate(group_by(gapminder, country),
       life_change = lifeExp - lag(lifeExp))
</pre>
</div>

<pre class="example">
# A tibble: 1,704 x 7
# Groups:   country [142]
       country continent  year lifeExp      pop gdpPercap life_change
        &lt;fctr&gt;    &lt;fctr&gt; &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;       &lt;dbl&gt;
 1 Afghanistan      Asia  1952  28.801  8425333  779.4453          NA
 2 Afghanistan      Asia  1957  30.332  9240934  820.8530       1.531
 3 Afghanistan      Asia  1962  31.997 10267083  853.1007       1.665
 4 Afghanistan      Asia  1967  34.020 11537966  836.1971       2.023
 5 Afghanistan      Asia  1972  36.088 13079460  739.9811       2.068
 6 Afghanistan      Asia  1977  38.438 14880372  786.1134       2.350
 7 Afghanistan      Asia  1982  39.854 12881816  978.0114       1.416
 8 Afghanistan      Asia  1987  40.822 13867957  852.3959       0.968
 9 Afghanistan      Asia  1992  41.674 16317921  649.3414       0.852
10 Afghanistan      Asia  1997  41.763 22227415  635.3414       0.089
# ... with 1,694 more rows
</pre>
</div>
</div>

<div id="outline-container-orgf55697a" class="outline-3">
<h3 id="orgf55697a"><span class="section-number-3">5.13</span> <code>group_by</code>, continued</h3>
<div class="outline-text-3" id="text-5-13">
<ul class="org-ul">
<li>You can group by multiple variables</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">summarize(group_by(gapminder, continent, year),
          mean_life = mean(lifeExp))
</pre>
</div>

<pre class="example">
# A tibble: 60 x 3
# Groups:   continent [?]
   continent  year mean_life
      &lt;fctr&gt; &lt;int&gt;     &lt;dbl&gt;
 1    Africa  1952  39.13550
 2    Africa  1957  41.26635
 3    Africa  1962  43.31944
 4    Africa  1967  45.33454
 5    Africa  1972  47.45094
 6    Africa  1977  49.58042
 7    Africa  1982  51.59287
 8    Africa  1987  53.34479
 9    Africa  1992  53.62958
10    Africa  1997  53.59827
# ... with 50 more rows
</pre>
</div>
</div>

<div id="outline-container-org2e3c173" class="outline-3">
<h3 id="org2e3c173"><span class="section-number-3">5.14</span> Chaining</h3>
<div class="outline-text-3" id="text-5-14">
<ul class="org-ul">
<li>What if we want to select all countries in Africa and calculate mean life expectancy by year?</li>
</ul>
<ul class="org-ul">
<li>This is easy to do because the dplyr functions always take the data as their first argument and always return a data.frame</li>
</ul>
</div>
</div>
<div id="outline-container-org5169392" class="outline-3">
<h3 id="org5169392"><span class="section-number-3">5.15</span> Chaining, continued</h3>
<div class="outline-text-3" id="text-5-15">
<ul class="org-ul">
<li>One option:</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">summarize(group_by(filter(gapminder,
                          continent == <span style="color: #2d9574;">"Africa"</span>),
                   year),
          mean_life = mean(lifeExp))
</pre>
</div>
<ul class="org-ul">
<li>Or we could assign to objects along the way</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">just_africa <span style="color: #a45bad;">&lt;-</span> filter(gapminder,continent == <span style="color: #2d9574;">"Africa"</span>),
africa_by_year <span style="color: #a45bad;">&lt;-</span> group_by(just_africa, year)
summarize(africa_by_year, mean_life = mean(lifeExp))
</pre>
</div>
</div>
</div>
<div id="outline-container-org7a671f6" class="outline-3">
<h3 id="org7a671f6"><span class="section-number-3">5.16</span> Piping</h3>
<div class="outline-text-3" id="text-5-16">
<ul class="org-ul">
<li>Both of those have downsides, though</li>
</ul>
<ul class="org-ul">
<li>We&rsquo;ll use the <i>pipe</i> <code>%&gt;%</code> to &ldquo;pipe&rdquo; the thing on the left into the thing on the right:</li>
<li><b>Tip:</b> In Rstudio, use Ctrl+shift+m (Cmd+shift+m) to get <code>%&gt;%</code></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">gapminder <span style="color: #a45bad;">%&gt;%</span>
  filter(continent == <span style="color: #2d9574;">"Africa"</span>) <span style="color: #a45bad;">%&gt;%</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-R">group_by(year) <span style="color: #a45bad;">%&gt;%</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-R">summarize(meanlife = mean(lifeExp))
</pre>
</div>
</div>
</div>
<div id="outline-container-org210df47" class="outline-3">
<h3 id="org210df47"><span class="section-number-3">5.17</span> Quiz</h3>
<div class="outline-text-3" id="text-5-17">
<ul class="org-ul">
<li>Create a data.frame containing the continent, year, avg life expectancy, and change in avg life expectancy</li>
</ul>
</div>
</div>
<div id="outline-container-org68d8590" class="outline-3">
<h3 id="org68d8590"><span class="section-number-3">5.18</span> Quiz answers</h3>
<div class="outline-text-3" id="text-5-18">
<div class="org-src-container">
<pre class="src src-R">gapminder <span style="color: #a45bad;">%&gt;%</span>
  group_by(continent, year) <span style="color: #a45bad;">%&gt;%</span>
  summarize(avg_life = mean(lifeExp)) <span style="color: #a45bad;">%&gt;%</span>
  mutate(change_life = avg_life - lag(avg_life))
</pre>
</div>

<pre class="example">
# A tibble: 60 x 4
# Groups:   continent [5]
   continent  year avg_life change_life
      &lt;fctr&gt; &lt;int&gt;    &lt;dbl&gt;       &lt;dbl&gt;
 1    Africa  1952 39.13550          NA
 2    Africa  1957 41.26635  2.13084615
 3    Africa  1962 43.31944  2.05309615
 4    Africa  1967 45.33454  2.01509615
 5    Africa  1972 47.45094  2.11640385
 6    Africa  1977 49.58042  2.12948077
 7    Africa  1982 51.59287  2.01244231
 8    Africa  1987 53.34479  1.75192308
 9    Africa  1992 53.62958  0.28478846
10    Africa  1997 53.59827 -0.03130769
# ... with 50 more rows
</pre>
</div>
</div>

<div id="outline-container-org410bcbf" class="outline-3">
<h3 id="org410bcbf"><span class="section-number-3">5.19</span> Ungrouping</h3>
<div class="outline-text-3" id="text-5-19">
<ul class="org-ul">
<li>Note that our answer had &ldquo;continent&rdquo; as a group</li>
<li>It&rsquo;s easy to forget about this, so if you&rsquo;re saving the object for use later, you may want to run <code>ungroup()</code> to undo the grouping on the data.frame.</li>
</ul>
</div>
</div>
<div id="outline-container-org3211490" class="outline-3">
<h3 id="org3211490"><span class="section-number-3">5.20</span> Other data manipulation</h3>
<div class="outline-text-3" id="text-5-20">
<ul class="org-ul">
<li>Those commands take care of the most common data manipulation tasks</li>
<li>There&rsquo;s tons more but we don&rsquo;t have the time to go over them all</li>
<li>Search engines and R&rsquo;s help are your friend</li>
</ul>
</div>
</div>
<div id="outline-container-orgeb9971d" class="outline-3">
<h3 id="orgeb9971d"><span class="section-number-3">5.21</span> Review</h3>
<div class="outline-text-3" id="text-5-21">
<ul class="org-ul">
<li>We learned how to use some of the most common <code>dplyr</code> functions to manipulate data (filter, select, mutate, summarize)</li>
<li><code>group_by</code> makes doing this by groups super easy</li>
<li>Piping can make it easier to read code</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgdbb0d6c" class="outline-2">
<h2 id="orgdbb0d6c"><span class="section-number-2">6</span> Diamonds</h2>
<div class="outline-text-2" id="text-6">
</div><div id="outline-container-orgb786d27" class="outline-3">
<h3 id="orgb786d27"><span class="section-number-3">6.1</span> The diamonds dataset</h3>
<div class="outline-text-3" id="text-6-1">
<ul class="org-ul">
<li>We just learned a lot, let&rsquo;s apply some of it to a new dataset</li>
<li>I&rsquo;m also going to switch from this powerpoint to a &ldquo;live demo!&rdquo;</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org3531164" class="outline-2">
<h2 id="org3531164"><span class="section-number-2">7</span> Reporting from R</h2>
<div class="outline-text-2" id="text-7">
</div><div id="outline-container-org0a880d7" class="outline-3">
<h3 id="org0a880d7"><span class="section-number-3">7.1</span> Reporting</h3>
<div class="outline-text-3" id="text-7-1">
<ul class="org-ul">
<li>We&rsquo;ve learned most of what you need to do data analysis!</li>
<li>Now let&rsquo;s do a new analysis on how to report, so we&rsquo;ll learn
<ul class="org-ul">
<li>How to report</li>
<li>Review much of what we learned</li>
<li>Learn a few more tricks and tips</li>
</ul></li>
<li>Right now is a good time to &ldquo;restart&rdquo; R and to make a project</li>
<li>I put mine in <code>~/research/awesome-paper/</code> but you can put yours wherever!</li>
</ul>
</div>
</div>
<div id="outline-container-orgd1a1140" class="outline-3">
<h3 id="orgd1a1140"><span class="section-number-3">7.2</span> New data</h3>
<div class="outline-text-3" id="text-7-2">
<ul class="org-ul">
<li>Let&rsquo;s change the dataset we&rsquo;re using, just for something new:</li>
<li>We&rsquo;ll use the <code>midwest</code> dataset from <code>ggplot2</code>, which has info on some U.S. midwest counties:</li>
</ul>
<div class="org-src-container">
<pre class="src src-R"><span style="color: #a45bad;">library</span>(tidyverse)
midwest
</pre>
</div>
</div>
</div>
<div id="outline-container-org06d5d90" class="outline-3">
<h3 id="org06d5d90"><span class="section-number-3">7.3</span> Descriptive statistics</h3>
<div class="outline-text-3" id="text-7-3">
<ul class="org-ul">
<li>Let&rsquo;s look at the relationship between college education and the percent living in poverty. And maybe this looks different in metro areas, so let&rsquo;s keep that in mind too.</li>
</ul>
<ul class="org-ul">
<li>I always like to show some descriptive statistics</li>
<li>Find the mean and standard deviation of our three variables!</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">midwest <span style="color: #a45bad;">%&gt;%</span>
  select(percbelowpoverty, percollege, inmetro) <span style="color: #a45bad;">%&gt;%</span>
  summarize_all(funs(mean, sd))
</pre>
</div>
</div>
</div>

<div id="outline-container-org7db9803" class="outline-3">
<h3 id="org7db9803"><span class="section-number-3">7.4</span> Functions</h3>
<div class="outline-text-3" id="text-7-4">
<ul class="org-ul">
<li>What if we want another function other than mean, sd, etc?</li>
<li>Very likely that it&rsquo;s either in base R or someone has written it</li>
<li>Or you can write a function yourself!</li>
<li>This is actually really easy in R</li>
</ul>
</div>
</div>
<div id="outline-container-org4308e64" class="outline-3">
<h3 id="org4308e64"><span class="section-number-3">7.5</span> Custom functions</h3>
<div class="outline-text-3" id="text-7-5">
<ul class="org-ul">
<li>Let&rsquo;s pretend R didn&rsquo;t have a <code>mean</code> function</li>
<li>How would we write it?</li>
<li>What do we need to find?</li>
</ul>
<p>
\[ \frac{1}{n} \sum x  \]
</p>
<div class="org-src-container">
<pre class="src src-R">sum(x) / length(x)
</pre>
</div>
</div>
</div>
<div id="outline-container-org4101247" class="outline-3">
<h3 id="org4101247"><span class="section-number-3">7.6</span> Custom functions</h3>
<div class="outline-text-3" id="text-7-6">
<div class="org-src-container">
<pre class="src src-R"><span style="color: #bc6ec5; font-weight: bold;">my_mean</span> <span style="color: #a45bad;">&lt;-</span> <span style="color: #4f97d7; font-weight: bold;">function</span>(x){
  sum(x) / length(x)
}
my_mean(-<span style="color: #a45bad;">1</span>:<span style="color: #a45bad;">10</span>)
</pre>
</div>

<pre class="example">
[1] 4.5

</pre>

<p>
But what about NA???
</p>
</div>
</div>
<div id="outline-container-org3273624" class="outline-3">
<h3 id="org3273624"><span class="section-number-3">7.7</span> If statements</h3>
<div class="outline-text-3" id="text-7-7">
<ul class="org-ul">
<li>An <code>if</code> statement allows us to conditionally execute code</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">my_name <span style="color: #a45bad;">&lt;-</span> <span style="color: #2d9574;">"Alex"</span>
<span style="color: #4f97d7; font-weight: bold;">if</span> (my_name == <span style="color: #2d9574;">"Alex"</span>){
  print(<span style="color: #2d9574;">"I'm Alex!!!"</span>)
} <span style="color: #4f97d7; font-weight: bold;">else</span>{
  print(<span style="color: #2d9574;">"You aren't Alex!!!"</span>)
}
</pre>
</div>
</div>
</div>
<div id="outline-container-orga93dec0" class="outline-3">
<h3 id="orga93dec0"><span class="section-number-3">7.8</span> Back to the NA problem</h3>
<div class="outline-text-3" id="text-7-8">
<p>
How to modify our function???
</p>
<div class="org-src-container">
<pre class="src src-R"><span style="color: #bc6ec5; font-weight: bold;">my_mean</span> <span style="color: #a45bad;">&lt;-</span> <span style="color: #4f97d7; font-weight: bold;">function</span>(x){
  sum(x) / length(x)
}
</pre>
</div>
<ul class="org-ul">
<li><b>Solution:</b> Use an if statement! But we gotta let the user tell us whether to remove NA&#x2026;</li>
</ul>
</div>
</div>
<div id="outline-container-org101acba" class="outline-3">
<h3 id="org101acba"><span class="section-number-3">7.9</span> Arguments and defaults</h3>
<div class="outline-text-3" id="text-7-9">
<div class="org-src-container">
<pre class="src src-R"><span style="color: #bc6ec5; font-weight: bold;">my_mean</span> <span style="color: #a45bad;">&lt;-</span> <span style="color: #4f97d7; font-weight: bold;">function</span>(x, na.rm = <span style="color: #ce537a; font-weight: bold;">FALSE</span>){
  <span style="color: #4f97d7; font-weight: bold;">if</span>(na.rm){ x <span style="color: #a45bad;">&lt;-</span> x[!is.na(x)]}
  sum(x) / length(x)
}
</pre>
</div>
</div>
</div>
<div id="outline-container-org089b3de" class="outline-3">
<h3 id="org089b3de"><span class="section-number-3">7.10</span> Test your functions</h3>
<div class="outline-text-3" id="text-7-10">
<p>
Always test a function to make sure it works!
</p>
<div class="org-src-container">
<pre class="src src-R">my_mean(c(<span style="color: #ce537a; font-weight: bold;">NA</span>, <span style="color: #a45bad;">0</span>, <span style="color: #a45bad;">1</span>), <span style="color: #ce537a; font-weight: bold;">TRUE</span>)
my_mean(c(<span style="color: #ce537a; font-weight: bold;">NA</span>, <span style="color: #a45bad;">0</span>, <span style="color: #a45bad;">1</span>), <span style="color: #ce537a; font-weight: bold;">FALSE</span>)
</pre>
</div>
</div>
</div>
<div id="outline-container-org73b37a6" class="outline-3">
<h3 id="org73b37a6"><span class="section-number-3">7.11</span> Back to our regularly scheduled program&#x2026;</h3>
<div class="outline-text-3" id="text-7-11">
<div class="org-src-container">
<pre class="src src-R">midwest <span style="color: #a45bad;">%&gt;%</span>
  select(percbelowpoverty, percollege, inmetro) <span style="color: #a45bad;">%&gt;%</span>
  summarize_all(funs(mean, sd))
</pre>
</div>
<ul class="org-ul">
<li>But what if we want to show that in our paper?</li>
</ul>
</div>
</div>
<div id="outline-container-org4d49167" class="outline-3">
<h3 id="org4d49167"><span class="section-number-3">7.12</span> stargazer</h3>
<div class="outline-text-3" id="text-7-12">
<ul class="org-ul">
<li>There are several packages that let you easily make \LaTeX&nbsp;tables, let&rsquo;s use <code>stargazer</code>:</li>
</ul>
<div class="org-src-container">
<pre class="src src-R"><span style="color: #a45bad;">library</span>(stargazer)
</pre>
</div>
<ul class="org-ul">
<li>Can handle Word too, need to do an html dance. See package docs.</li>
</ul>
</div>
</div>
<div id="outline-container-org67eceb8" class="outline-3">
<h3 id="org67eceb8"><span class="section-number-3">7.13</span> Descriptive stats, latex table:</h3>
<div class="outline-text-3" id="text-7-13">
<div class="org-src-container">
<pre class="src src-R">midwest <span style="color: #a45bad;">%&gt;%</span>
  select(percbelowpoverty, percollege, inmetro) <span style="color: #a45bad;">%&gt;%</span>
  <span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">stargazer is picky about tibbles vs data.frames</span>
  as.data.frame <span style="color: #a45bad;">%&gt;%</span>
  stargazer(out = <span style="color: #2d9574;">"../output/desc-stats.tex"</span>,
            title = <span style="color: #2d9574;">"Descriptive Statistics"</span>)
</pre>
</div>
</div>
</div>
<div id="outline-container-orgea13507" class="outline-3">
<h3 id="orgea13507"><span class="section-number-3">7.14</span> Descriptive stats, latex table result</h3>
<div class="outline-text-3" id="text-7-14">
<ul class="org-ul">
<li>use <code>\input{output/desc-stats.tex}</code> to import the table into your paper</li>
</ul>
</div>
</div>
<div id="outline-container-org489183f" class="outline-3">
<h3 id="org489183f"><span class="section-number-3">7.15</span> Plot 1</h3>
<div class="outline-text-3" id="text-7-15">
<ul class="org-ul">
<li>Let&rsquo;s make a scatterplot!</li>
</ul>
<ul class="org-ul">
<li>Make a scatterplot with <code>percbelowpoverty</code> on the y-axis and include info on <code>percollege</code> and <code>inmetro</code></li>
</ul>
</div>
</div>

<div id="outline-container-orgee1fa9a" class="outline-3">
<h3 id="orgee1fa9a"><span class="section-number-3">7.16</span> Plot 1, simple</h3>
<div class="outline-text-3" id="text-7-16">
<div class="org-src-container">
<pre class="src src-R">g <span style="color: #a45bad;">&lt;-</span> midwest <span style="color: #a45bad;">%&gt;%</span>
  <span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">inmetro is a number but needs to be discrete.</span>
  <span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">as.logical will convert so that a 0 is FALSE</span>
  mutate(inmetro = as.logical(inmetro)) <span style="color: #a45bad;">%&gt;%</span>
  ggplot(aes(percollege, percbelowpoverty,
             color = inmetro,
             shape = inmetro)) +
  geom_point()
</pre>
</div>
</div>
</div>
<div id="outline-container-org7842189" class="outline-3">
<h3 id="org7842189"><span class="section-number-3">7.17</span> </h3>
<div class="outline-text-3" id="text-7-17">
<p>
<a href="figures/my-plot1-simple.pdf">figures/my-plot1-simple.pdf</a>
</p>
</div>
</div>
<div id="outline-container-org3ceb55d" class="outline-3">
<h3 id="org3ceb55d"><span class="section-number-3">7.18</span> More about graphs</h3>
<div class="outline-text-3" id="text-7-18">
<ul class="org-ul">
<li>Note that I assigned the plot to an object <code>g</code></li>
<li>We might want to change some more stuff about the graph (legends, assign colors, etc)</li>
<li>This way I don&rsquo;t have to re-run the same code</li>
</ul>
</div>
</div>
<div id="outline-container-org76644f9" class="outline-3">
<h3 id="org76644f9"><span class="section-number-3">7.19</span> Adjust the scale</h3>
<div class="outline-text-3" id="text-7-19">
<ul class="org-ul">
<li>You may want to change the color, label legends, etc</li>
<li>use <code>scale_aes_type</code> to do so</li>
<li>So, for example, we can do <code>scale_color_manual</code> to change the properties of the color scale.</li>
<li>Let&rsquo;s change it so that metro areas are blue and rural areas are red:</li>
</ul>
<div class="org-src-container">
<pre class="src src-R"><span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">Plain </span><span style="color: #ffffff; background-color: #FF0000;">red</span><span style="color: #2aa1ae; background-color: #292e34;"> is super harsh, let's scale it back a bit:</span>
g + scale_color_manual(values = c(<span style="color: #2d9574;">"</span><span style="color: #ffffff; background-color: #CD0000;">red3</span><span style="color: #2d9574;">"</span>, <span style="color: #2d9574;">"</span><span style="color: #ffffff; background-color: #0000FF;">blue</span><span style="color: #2d9574;">"</span>))
</pre>
</div>
</div>
</div>
<div id="outline-container-org91ef370" class="outline-3">
<h3 id="org91ef370"><span class="section-number-3">7.20</span> </h3>
<div class="outline-text-3" id="text-7-20">
<p>
<a href="figures/my-plot1-color.pdf">figures/my-plot1-color.pdf</a>
</p>
</div>
</div>
<div id="outline-container-orgecb442a" class="outline-3">
<h3 id="orgecb442a"><span class="section-number-3">7.21</span> Changing legend labels</h3>
<div class="outline-text-3" id="text-7-21">
<ul class="org-ul">
<li>Of course, <code>FALSE</code> and <code>TRUE</code> are not good legend labels. We can change those too with the <code>scale_color_manual</code> command:</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">g + scale_color_manual(values = c(<span style="color: #2d9574;">"</span><span style="color: #ffffff; background-color: #CD0000;">red3</span><span style="color: #2d9574;">"</span>, <span style="color: #2d9574;">"</span><span style="color: #ffffff; background-color: #0000FF;">blue</span><span style="color: #2d9574;">"</span>),
                       labels = c(<span style="color: #2d9574;">"Rural"</span>, <span style="color: #2d9574;">"Urban"</span>))
</pre>
</div>
</div>
</div>
<div id="outline-container-orge17ab93" class="outline-3">
<h3 id="orge17ab93"><span class="section-number-3">7.22</span> </h3>
<div class="outline-text-3" id="text-7-22">
<p>
<a href="figures/my-plot1-scales.pdf">figures/my-plot1-scales.pdf</a>
</p>
</div>
</div>
<div id="outline-container-org0d4a609" class="outline-3">
<h3 id="org0d4a609"><span class="section-number-3">7.23</span> UGHHHHHHHHH</h3>
<div class="outline-text-3" id="text-7-23">
<ul class="org-ul">
<li>Now the legends are separate, though. Need to tell the shape aesthetic to use the same labels!</li>
<li>While we&rsquo;re at it, let&rsquo;s remove the legend title (name):</li>
<li>Since we&rsquo;re done changing the scales, let&rsquo;s reassign <code>g</code></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">g <span style="color: #a45bad;">&lt;-</span> g + scale_color_manual(values = c(<span style="color: #2d9574;">"</span><span style="color: #ffffff; background-color: #CD0000;">red3</span><span style="color: #2d9574;">"</span>, <span style="color: #2d9574;">"</span><span style="color: #ffffff; background-color: #0000FF;">blue</span><span style="color: #2d9574;">"</span>),
                           labels = c(<span style="color: #2d9574;">"Rural"</span>, <span style="color: #2d9574;">"Urban"</span>),
                           name = <span style="color: #2d9574;">""</span>) +
  scale_shape_discrete(labels = c(<span style="color: #2d9574;">"Rural"</span>, <span style="color: #2d9574;">"Urban"</span>),
                       name = <span style="color: #2d9574;">""</span>)
</pre>
</div>
</div>
</div>
<div id="outline-container-orgaa2adbe" class="outline-3">
<h3 id="orgaa2adbe"><span class="section-number-3">7.24</span> </h3>
<div class="outline-text-3" id="text-7-24">
<p>
<a href="figures/my-plot1-scales2.pdf">figures/my-plot1-scales2.pdf</a>
</p>
</div>
</div>
<div id="outline-container-orgdee6f87" class="outline-3">
<h3 id="orgdee6f87"><span class="section-number-3">7.25</span> Axis labels</h3>
<div class="outline-text-3" id="text-7-25">
<ul class="org-ul">
<li>We should probably fix up our axis labels</li>
<li>Note that if you want to give the plot a title, subtitle, or caption, you may do so here</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">g <span style="color: #a45bad;">&lt;-</span> g + labs(y = <span style="color: #2d9574;">"Percent below poverty"</span>,
             x = <span style="color: #2d9574;">"Percent with a college degree"</span>)
</pre>
</div>
</div>
</div>
<div id="outline-container-orge45c2ff" class="outline-3">
<h3 id="orge45c2ff"><span class="section-number-3">7.26</span> </h3>
<div class="outline-text-3" id="text-7-26">
<p>
<a href="figures/my-plot1-labs.pdf">figures/my-plot1-labs.pdf</a>
</p>
</div>
</div>
<div id="outline-container-orgfd07dea" class="outline-3">
<h3 id="orgfd07dea"><span class="section-number-3">7.27</span> Background and themes</h3>
<div class="outline-text-3" id="text-7-27">
<ul class="org-ul">
<li>I&rsquo;m not a fan of the default grey background.</li>
<li>You can adjust everything yourself, but there are several themes that come built-in</li>
<li>The package <code>ggthemes</code> has many other themes</li>
<li>You can make it look like you&rsquo;re graphing for the economist. Or from Stata</li>
</ul>
</div>
</div>
<div id="outline-container-orgc4b3857" class="outline-3">
<h3 id="orgc4b3857"><span class="section-number-3">7.28</span> Much themes, wow</h3>
<div class="outline-text-3" id="text-7-28">
<div class="org-src-container">
<pre class="src src-R">g + theme_grey()
g + theme_gray()
g + theme_bw()
g + theme_linedraw()
g + theme_light()
g + theme_dark()
g + theme_minimal()
g + theme_classic()
g + theme_void()
</pre>
</div>
</div>
</div>
<div id="outline-container-org4ea0bd5" class="outline-3">
<h3 id="org4ea0bd5"><span class="section-number-3">7.29</span> Plot 1, full</h3>
<div class="outline-text-3" id="text-7-29">
<div class="org-src-container">
<pre class="src src-R">midwest <span style="color: #a45bad;">%&gt;%</span>
  mutate(inmetro = as.logical(inmetro)) <span style="color: #a45bad;">%&gt;%</span>
  ggplot(aes(percollege, percbelowpoverty,
             color = inmetro,
             shape = inmetro)) +
  geom_point() +
  scale_color_manual(values = c(<span style="color: #2d9574;">"</span><span style="color: #ffffff; background-color: #CD0000;">red3</span><span style="color: #2d9574;">"</span>, <span style="color: #2d9574;">"</span><span style="color: #ffffff; background-color: #0000FF;">blue</span><span style="color: #2d9574;">"</span>), labels = c(<span style="color: #2d9574;">"Rural"</span>, <span style="color: #2d9574;">"Urban"</span>),
                     name = <span style="color: #2d9574;">""</span>) +
  scale_shape_discrete(labels = c(<span style="color: #2d9574;">"Rural"</span>, <span style="color: #2d9574;">"Urban"</span>), name = <span style="color: #2d9574;">""</span>) +
  labs(x = <span style="color: #2d9574;">"Percent below poverty line"</span>,
       y = <span style="color: #2d9574;">"Percent with a college education"</span>) +
  theme_bw()
</pre>
</div>
</div>
</div>
<div id="outline-container-orgd5f2d1d" class="outline-3">
<h3 id="orgd5f2d1d"><span class="section-number-3">7.30</span> </h3>
<div class="outline-text-3" id="text-7-30">
<p>
<a href="figures/my-plot1-themed.pdf">figures/my-plot1-themed.pdf</a>
</p>
</div>
</div>
<div id="outline-container-orgc1e9ed1" class="outline-3">
<h3 id="orgc1e9ed1"><span class="section-number-3">7.31</span> How to save ggplots</h3>
<div class="outline-text-3" id="text-7-31">
<ul class="org-ul">
<li>The <code>ggsave</code> function saves a plot (by default, the last one you plotted)</li>
<li>It&rsquo;s important to specify the width and height</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">ggsave(<span style="color: #2d9574;">"../output/my-scatterplot.eps"</span>,
       <span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">Important to specify!!!</span>
       width = <span style="color: #a45bad;">9</span>, height = <span style="color: #a45bad;">6.5</span>)
</pre>
</div>
</div>
</div>
<div id="outline-container-orgfd0b980" class="outline-3">
<h3 id="orgfd0b980"><span class="section-number-3">7.32</span> Linear regression</h3>
<div class="outline-text-3" id="text-7-32">
<ul class="org-ul">
<li><p>
Let&rsquo;s run a linear predicting poverty with education and include an interaction term for inmetro
</p>
<ul class="org-ul">
<li>Yes, I&rsquo;m ignoring all kinds of issues with this particular model</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">my_reg <span style="color: #a45bad;">&lt;-</span> lm(percbelowpoverty ~ percollege * inmetro,
            data = midwest)
summary(my_reg)
</pre>
</div></li>
</ul>
</div>
</div>

<div id="outline-container-org4bfab28" class="outline-3">
<h3 id="org4bfab28"><span class="section-number-3">7.33</span> Linear regression table</h3>
<div class="outline-text-3" id="text-7-33">
<div class="org-src-container">
<pre class="src src-R">stargazer(my_reg,
          out = <span style="color: #2d9574;">"../output/my-reg.tex"</span>)
</pre>
</div>
<ul class="org-ul">
<li>Use <code>\input{output/my-reg.tex}</code> in your \LaTeX&nbsp; document to import the table!</li>
</ul>
</div>
</div>
<div id="outline-container-org0d9017e" class="outline-3">
<h3 id="org0d9017e"><span class="section-number-3">7.34</span> </h3>
<div class="outline-text-3" id="text-7-34">
</div>
</div>
<div id="outline-container-orgff5483e" class="outline-3">
<h3 id="orgff5483e"><span class="section-number-3">7.35</span> Multiple models</h3>
<div class="outline-text-3" id="text-7-35">
<ul class="org-ul">
<li>Oftentimes, we want multiple models</li>
<li>You can, of course, copy paste code, but that&rsquo;s error prone (typos, ugh), and difficult to change later on</li>
<li>There&rsquo;s an easy solution for this, but first let&rsquo;s talk about a data structure we haven&rsquo;t mentioned much yet:</li>
</ul>
<p>
THE LIST
</p>
</div>
</div>
<div id="outline-container-orgd8a6d46" class="outline-3">
<h3 id="orgd8a6d46"><span class="section-number-3">7.36</span> Lists</h3>
<div class="outline-text-3" id="text-7-36">
<ul class="org-ul">
<li>A list is one dimensions (like numeric, logical, character, factor)</li>
</ul>
<ul class="org-ul">
<li>But each element can be of a different type</li>
</ul>
<ul class="org-ul">
<li>We can create lists with the <code>list</code> command</li>
<li>Look at the difference:</li>
</ul>
</div>
</div>
<div id="outline-container-org367b135" class="outline-3">
<h3 id="org367b135"><span class="section-number-3">7.37</span> Lists, continued</h3>
<div class="outline-text-3" id="text-7-37">
<div class="org-src-container">
<pre class="src src-R">c(<span style="color: #a45bad;">3</span>, <span style="color: #ce537a; font-weight: bold;">TRUE</span>, <span style="color: #2d9574;">"Nancy"</span>)
</pre>
</div>

<pre class="example">
[1] "3"     "TRUE"  "Nancy"

</pre>

<div class="org-src-container">
<pre class="src src-R">list(<span style="color: #a45bad;">3</span>, <span style="color: #ce537a; font-weight: bold;">TRUE</span>, <span style="color: #2d9574;">"Nancy"</span>)
</pre>
</div>

<pre class="example">
[[1]]
[1] 3

[[2]]
[1] TRUE

[[3]]
[1] "Nancy"

</pre>
</div>
</div>

<div id="outline-container-org9c5a23c" class="outline-3">
<h3 id="org9c5a23c"><span class="section-number-3">7.38</span> Lists, more</h3>
<div class="outline-text-3" id="text-7-38">
<ul class="org-ul">
<li>Subsetting lists can be a little weird</li>
<li>We use <code>[[</code>  or <code>[</code> to subset</li>
<li>First, create a list:</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">x <span style="color: #a45bad;">&lt;-</span> list(c(<span style="color: #a45bad;">1</span>:<span style="color: #a45bad;">10</span>),
         c(<span style="color: #ce537a; font-weight: bold;">TRUE</span>, <span style="color: #ce537a; font-weight: bold;">NA</span>, <span style="color: #ce537a; font-weight: bold;">TRUE</span>),
         c(<span style="color: #2d9574;">"Bob"</span>, <span style="color: #2d9574;">"Alice"</span>, <span style="color: #2d9574;">"Nancy"</span>, <span style="color: #2d9574;">"Drew"</span>))
</pre>
</div>
</div>
</div>
<div id="outline-container-org7e1f39a" class="outline-3">
<h3 id="org7e1f39a"><span class="section-number-3">7.39</span> Subsetting lists</h3>
<div class="outline-text-3" id="text-7-39">
<ul class="org-ul">
<li>What is the difference:</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">x[[<span style="color: #a45bad;">1</span>]]
x[<span style="color: #a45bad;">1</span>]
</pre>
</div>
</div>
</div>
<div id="outline-container-org6cf8b91" class="outline-3">
<h3 id="org6cf8b91"><span class="section-number-3">7.40</span> Named lists</h3>
<div class="outline-text-3" id="text-7-40">
<ul class="org-ul">
<li>The double bracket contains the thing at the position,</li>
<li>Single bracket returns a list of the thing at the position</li>
<li>Elements of a list can have names:</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">names(x) <span style="color: #a45bad;">&lt;-</span> c(<span style="color: #2d9574;">"nums"</span>, <span style="color: #2d9574;">"logs"</span>, <span style="color: #2d9574;">"chars"</span>)
<span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">Can also specify at creation time e.g. list(nums = 1:10) etc</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgf094647" class="outline-3">
<h3 id="orgf094647"><span class="section-number-3">7.41</span> Named lists, continued</h3>
<div class="outline-text-3" id="text-7-41">
<div class="org-src-container">
<pre class="src src-R">x
</pre>
</div>

<pre class="example">
$nums
 [1]  1  2  3  4  5  6  7  8  9 10

$logs
[1] TRUE   NA TRUE

$chars
[1] "Bob"   "Alice" "Nancy" "Drew"

</pre>
</div>
</div>

<div id="outline-container-org3451319" class="outline-3">
<h3 id="org3451319"><span class="section-number-3">7.42</span> Subsetting named lists</h3>
<div class="outline-text-3" id="text-7-42">
<ul class="org-ul">
<li>We can now access elements of the list by name instead of by position:</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">x$chars
</pre>
</div>

<pre class="example">
[1] "Bob"   "Alice" "Nancy" "Drew"

</pre>
</div>
</div>

<div id="outline-container-orgd03b403" class="outline-3">
<h3 id="orgd03b403"><span class="section-number-3">7.43</span> Data frames are lists too!</h3>
<div class="outline-text-3" id="text-7-43">
<ul class="org-ul">
<li>Remember we can use <code>dataframe$varname</code> to access variables from a data frame?</li>
</ul>
<ul class="org-ul">
<li>Does this look similar to what we just did with lists?</li>
</ul>
<ul class="org-ul">
<li>That&rsquo;s because data frames are secretly lists themselves!</li>
</ul>
</div>
</div>
<div id="outline-container-org7955904" class="outline-3">
<h3 id="org7955904"><span class="section-number-3">7.44</span> Back to modeling</h3>
<div class="outline-text-3" id="text-7-44">
<ul class="org-ul">
<li>OK, why did we just learn about lists?</li>
</ul>
<ul class="org-ul">
<li>We were modeling percent below poverty with an interaction between college education and metro area status</li>
</ul>
<ul class="org-ul">
<li>What if we want to &ldquo;build the model&rdquo; by including constituent variables one at a time?</li>
<li>One way:</li>
</ul>
</div>
</div>
<div id="outline-container-org55a5ca7" class="outline-3">
<h3 id="org55a5ca7"><span class="section-number-3">7.45</span> Multiple models</h3>
<div class="outline-text-3" id="text-7-45">
<div class="org-src-container">
<pre class="src src-R">model1 <span style="color: #a45bad;">&lt;-</span> lm(percbelowpoverty ~ percollege, data = midwest)
model2 <span style="color: #a45bad;">&lt;-</span> lm(percbelowpoverty ~ inmetro, data = midwest)
model3 <span style="color: #a45bad;">&lt;-</span> lm(percbelowpoverty ~ percollege * inmetro, data = midwest)
</pre>
</div>
</div>
</div>
<div id="outline-container-org059fd8f" class="outline-3">
<h3 id="org059fd8f"><span class="section-number-3">7.46</span> Multiple models</h3>
<div class="outline-text-3" id="text-7-46">
<ul class="org-ul">
<li>But if we do that, we now have three models just floating around.</li>
<li>To get summary measures:</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">summary(model1)
summary(model2)
summary(model3)
</pre>
</div>
</div>
</div>
<div id="outline-container-org137c690" class="outline-3">
<h3 id="org137c690"><span class="section-number-3">7.47</span> Multiple models</h3>
<div class="outline-text-3" id="text-7-47">
<p>
Y-hats:
</p>
<div class="org-src-container">
<pre class="src src-R">predict(model1)
predict(model2)
predict(model3)
</pre>
</div>
</div>
</div>
<div id="outline-container-orgfa52aba" class="outline-3">
<h3 id="orgfa52aba"><span class="section-number-3">7.48</span> The problem</h3>
<div class="outline-text-3" id="text-7-48">
<ul class="org-ul">
<li>That&rsquo;s just with three models!</li>
<li>Sometimes we run many more and the problem only gets worse!</li>
</ul>
<ul class="org-ul">
<li><b>Idea!</b> let&rsquo;s use the list to make life easier!</li>
</ul>
</div>
</div>
<div id="outline-container-orgb6254d1" class="outline-3">
<h3 id="orgb6254d1"><span class="section-number-3">7.49</span> Multiple models with a list</h3>
<div class="outline-text-3" id="text-7-49">
<div class="org-src-container">
<pre class="src src-R">my_formulae <span style="color: #a45bad;">&lt;-</span> list(model1 = percbelowpoverty ~ percollege,
                   model2 = percbelowpoverty ~ inmetro,
                   model3 = percbelowpoverty ~ percollege * inmetro)
</pre>
</div>
</div>
</div>
<div id="outline-container-org4c0d1af" class="outline-3">
<h3 id="org4c0d1af"><span class="section-number-3">7.50</span> Run the models!</h3>
<div class="outline-text-3" id="text-7-50">
<ul class="org-ul">
<li>Base R provides <code>lapply</code> which iterates over lists</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">my_regs <span style="color: #a45bad;">&lt;-</span> lapply(my_formulae,
                 <span style="color: #4f97d7; font-weight: bold;">function</span>(l_ele){lm(l_ele, data = midwest)})
</pre>
</div>
<ul class="org-ul">
<li>First argument is a list, second is a function to apply to each element of the list</li>
<li>We use an <i>anonymous function</i> - one that we create on the fly. You could&rsquo;ve created a named function too like we did with <code>my_mean</code> previously</li>
</ul>
</div>
</div>
<div id="outline-container-org4d72b2c" class="outline-3">
<h3 id="org4d72b2c"><span class="section-number-3">7.51</span> Run the models!</h3>
<div class="outline-text-3" id="text-7-51">
<ul class="org-ul">
<li>I don&rsquo;t really like that syntax though so I use <code>map</code> from the <code>purrr</code> package.</li>
<li>This will do the same thing; the tilde magically creates an anonymous function in the background</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">my_regs <span style="color: #a45bad;">&lt;-</span> map(my_formulae, ~ lm(.x, data = midwest))
</pre>
</div>
</div>
</div>
<div id="outline-container-orga7a2085" class="outline-3">
<h3 id="orga7a2085"><span class="section-number-3">7.52</span> Summarize the models</h3>
<div class="outline-text-3" id="text-7-52">
<div class="org-src-container">
<pre class="src src-R">map(my_regs, summary)
</pre>
</div>
</div>
</div>
<div id="outline-container-org4c39fa9" class="outline-3">
<h3 id="org4c39fa9"><span class="section-number-3">7.53</span> Get predicted values</h3>
<div class="outline-text-3" id="text-7-53">
<div class="org-src-container">
<pre class="src src-R">map(my_regs, predict)
</pre>
</div>
</div>
</div>
<div id="outline-container-org2ce7f0d" class="outline-3">
<h3 id="org2ce7f0d"><span class="section-number-3">7.54</span> Get residuals</h3>
<div class="outline-text-3" id="text-7-54">
<div class="org-src-container">
<pre class="src src-R">map(my_regs, residuals)
</pre>
</div>
</div>
</div>
<div id="outline-container-org69e8890" class="outline-3">
<h3 id="org69e8890"><span class="section-number-3">7.55</span> Broom</h3>
<div class="outline-text-3" id="text-7-55">
<p>
The broom package has three functions that turns models into data.frames:
</p>
<ol class="org-ol">
<li><code>glance()</code> returns a row with model quality/complexity</li>
<li><code>tidy()</code> returns a row for each coefficient</li>
<li><code>augment()</code> returns a row for every row in the data, adding some values (usually residuals and the like)</li>
</ol>
</div>
</div>
<div id="outline-container-orgae4e4dc" class="outline-3">
<h3 id="orgae4e4dc"><span class="section-number-3">7.56</span> Get fit statistics</h3>
<div class="outline-text-3" id="text-7-56">
<div class="org-src-container">
<pre class="src src-R">map(my_regs, broom::glance)
</pre>
</div>
</div>
</div>
<div id="outline-container-org8004cb7" class="outline-3">
<h3 id="org8004cb7"><span class="section-number-3">7.57</span> broom::tidy</h3>
<div class="outline-text-3" id="text-7-57">
<div class="org-src-container">
<pre class="src src-R">map(my_regs, broom::tidy)
</pre>
</div>
</div>
</div>
<div id="outline-container-orga11324c" class="outline-3">
<h3 id="orga11324c"><span class="section-number-3">7.58</span> broom::augment</h3>
<div class="outline-text-3" id="text-7-58">
<div class="org-src-container">
<pre class="src src-R">map(my_regs, broom::augment)
</pre>
</div>
</div>
</div>
<div id="outline-container-orgca716ac" class="outline-3">
<h3 id="orgca716ac"><span class="section-number-3">7.59</span> Reporting multiple models</h3>
<div class="outline-text-3" id="text-7-59">
<ul class="org-ul">
<li>The stargazer function is smart enough to figure out multiple models:</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">stargazer(my_regs,
          out = <span style="color: #2d9574;">"../output/my-reg.tex"</span>)
</pre>
</div>
</div>
</div>
<div id="outline-container-orge37acd7" class="outline-3">
<h3 id="orge37acd7"><span class="section-number-3">7.60</span> </h3>
<div class="outline-text-3" id="text-7-60">
</div>
</div>
<div id="outline-container-org2e3bb5b" class="outline-3">
<h3 id="org2e3bb5b"><span class="section-number-3">7.61</span> Plotting predicted values</h3>
<div class="outline-text-3" id="text-7-61">
<ul class="org-ul">
<li>We usually want to plot the predicted values from our models</li>
<li>We&rsquo;ll keep using a linear model, but this can really be anything</li>
<li>Let&rsquo;s say we want to compare how adding the interaction term affects our predictions</li>
<li>One way: Plot predicted values from our first and third regressions!</li>
<li>Let&rsquo;s add them to our data.frame</li>
</ul>
</div>
</div>
<div id="outline-container-orgf7cf198" class="outline-3">
<h3 id="orgf7cf198"><span class="section-number-3">7.62</span> Getting predicted values</h3>
<div class="outline-text-3" id="text-7-62">
<div class="org-src-container">
<pre class="src src-R">my_midwest <span style="color: #a45bad;">&lt;-</span> midwest
my_midwest$pred_m1 <span style="color: #a45bad;">&lt;-</span> predict(my_regs$model1)
my_midwest$pred_m3 <span style="color: #a45bad;">&lt;-</span> predict(my_regs$model3)
</pre>
</div>
</div>
</div>
<div id="outline-container-org29d1148" class="outline-3">
<h3 id="org29d1148"><span class="section-number-3">7.63</span> Generate plots</h3>
<div class="outline-text-3" id="text-7-63">
<div class="org-src-container">
<pre class="src src-R">ggplot(my_midwest,
       aes(percollege)) +
  geom_line(aes(y = pred_m1)) +
  geom_line(aes(y = pred_m3,
                linetype = as.logical(inmetro)),
            color = <span style="color: #2d9574;">"</span><span style="color: #ffffff; background-color: #0000FF;">blue</span><span style="color: #2d9574;">"</span>)
</pre>
</div>
</div>
</div>
<div id="outline-container-org0688541" class="outline-3">
<h3 id="org0688541"><span class="section-number-3">7.64</span> </h3>
<div class="outline-text-3" id="text-7-64">
<p>
<a href="figures/predictions.pdf">figures/predictions.pdf</a>
</p>
</div>
</div>
<div id="outline-container-org0d3a218" class="outline-3">
<h3 id="org0d3a218"><span class="section-number-3">7.65</span> Merging</h3>
<div class="outline-text-3" id="text-7-65">
<ul class="org-ul">
<li>Let&rsquo;s talk about merging data!</li>
<li>Oftentimes we have different datasets that we need to merge together for whatever reason</li>
<li>dplyr refers to &ldquo;merging&rdquo; as &ldquo;joining,&rdquo; which is language borrowed from SQL</li>
<li>Let&rsquo;s go to another &ldquo;live demo&rdquo;</li>
<li>Let&rsquo;s look at two toy datasets that come with dplyr</li>
</ul>
</div>
</div>
<div id="outline-container-orgb0b7013" class="outline-3">
<h3 id="orgb0b7013"><span class="section-number-3">7.66</span> How to get help</h3>
<div class="outline-text-3" id="text-7-66">
<ul class="org-ul">
<li>Stack overflow (but have an MRE)</li>
<li>Twitter (#rstats)</li>
<li>Me! (branham@utexas.edu)</li>
</ul>
</div>
</div>
<div id="outline-container-orgc63b0b9" class="outline-3">
<h3 id="orgc63b0b9"><span class="section-number-3">7.67</span> Other tools that work well with R</h3>
<div class="outline-text-3" id="text-7-67">
<ul class="org-ul">
<li>Git</li>
<li>\LaTeX</li>
<li>(r)markdown</li>
</ul>
</div>
</div>
<div id="outline-container-org6c26306" class="outline-3">
<h3 id="org6c26306"><span class="section-number-3">7.68</span> </h3>
<div class="outline-text-3" id="text-7-68">
<p>
Thanks for coming!
</p>
</div>
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" class="footnum" href="#fnr.1">1</a></sup> <div class="footpara"><p class="footpara">
Technically, a <code>tibble</code>, but the difference isn&rsquo;t very much, so we&rsquo;ll ignore that
</p></div></div>


</div>
</div></div>
<div id="postamble" class="status">
<p class="date">Date: June 2017</p>
<p class="author">Author: J. Alexander Branham</p>
<p class="date">Created: 2017-06-16 Fri 19:10</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
